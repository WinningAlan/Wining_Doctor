(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-be886d66"],{3008:function(t,e,i){},"3d22":function(t,e,i){},"507c":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"operation-warp"},[i("div",{staticClass:"tabs-temp"},[i("el-radio-group",{attrs:{fill:"#0071e7"},on:{change:t.tapsExamine},model:{value:t.nowTemp,callback:function(e){t.nowTemp=e},expression:"nowTemp"}},t._l(t.tabsTemp,function(e,a){return e.Show?i("el-radio-button",{key:a,attrs:{label:e.Value}},[t._v(t._s(e.Text))]):t._e()}),1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"newOperation"==t.nowTemp,expression:"nowTemp=='newOperation'"}],staticClass:"newOperation"},[t.isReset?i("newOperation",{attrs:{commonObj:t.commonObj,isBorder:!1},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.submitForm;return[i("div",{staticClass:"btn"},[i("el-button",{staticClass:"reset",on:{click:t.reset}},[t._v("取消")]),i("el-button",{staticClass:"save",attrs:{type:"primary"},on:{click:function(e){t.save(a)}}},[t._v("保存")])],1)]}}])}):t._e()],1),i("div",{directives:[{name:"show",rawName:"v-show",value:"historyOperation"==t.nowTemp,expression:"nowTemp=='historyOperation'"}],staticClass:"historyOperation"},[i("div",{staticClass:"history-left"},[i("history-list",{ref:"historyList",attrs:{historyListData:t.historyListData,callback:t.historyItem}})],1),i("operation-table",{attrs:{tableData:t.tableData,callback:t.selectRow},scopedSlots:t._u([{key:"dd",fn:function(e){var a=e.scope;return[i("div",{staticClass:"dd-box"},[i("el-tooltip",{attrs:{effect:"dark",content:"引用",placement:"top-start"}},[8!=t.patientMsg.Status?i("svg-icon",{staticClass:"styleIcon",attrs:{iconClass:"quote"},on:{click:function(e){e.stopPropagation(),t.showTable(a.row)}}}):t._e()],1),1!==a.row.Status&&7!==a.row.Status?i("el-tooltip",{attrs:{effect:"dark",content:"打印",placement:"top-start"}},[i("svg-icon",{staticClass:"styleIcon",attrs:{iconClass:"printlist"},on:{click:function(e){e.stopPropagation(),t.print(a.row)}}})],1):t._e()],1)]}}])})],1),i("my-alter",{attrs:{visible:t.isShow,title:"手术申请单详请",callback:t.alterCallback,isfooter:!1}},[i("operationDeatil",{tag:"component",attrs:{commonObj:t.commonObj}}),t.isFooter&&8!=t.patientMsg.Status?i("div",{staticClass:"btnList"},[i("el-button",{staticClass:"save",on:{click:t.submitData}},[t._v("提交")]),i("el-button",{staticClass:"reset-list",on:{click:t.upData}},[t._v("修改")])],1):t._e()],1)],1)},s=[],o=(i("96cf"),i("1da1")),n=i("be94"),r=i("18e1"),l=i("2f62"),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"operation-deatil"},[i("el-form",{ref:"newOperation",staticClass:"demo-commonObj",attrs:{model:t.commonObj,"label-width":"100px"}},[i("div",{staticClass:"content"},[i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"术前诊断",prop:"DiagnosisName"}},[i("p",[t._v(t._s(t.commonObj.DiagnosisName))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"拟施手术",prop:"OperationName"}},[i("p",[t._v(t._s(t.commonObj.OperationName))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"手术等级",prop:"OperationLevel"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.OperationLevel,t.dictData.OperationLevel)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"手术类型",prop:"OperationType"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.OperationType,t.dictData.OperationType)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"手术室",prop:"OperationRoom"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.OperationRoom,t.dictData.OperationRoom)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"手术部位",prop:"OperationHumanBody"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.OperationHumanBody,t.dictData.OperationHumanBody)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"手术台次",prop:"OperationCountNo"}},[i("p",[t._v(t._s(t.commonObj.OperationCountNo))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"拟手术时间",prop:"ExpectOperationTime"}},[i("p",[t._v(t._s(t._f("timeFilter")(t.commonObj.ExpectOperationTime)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"体位",prop:"OperationHumanPosition"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.OperationHumanPosition,t.dictData.OperationHumanPosition)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"切口等级",prop:"IncisionLevel"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.IncisionLevel,t.dictData.OperationIncisionLevel)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"备血",prop:"IsBloodPreparation"}},[i("p",[t._v(t._s(t.commonObj.IsBloodPreparation?"有":"无"))])])],1),i("div",{staticClass:"item bloodTypeName"},[i("el-form-item",{attrs:{label:"血型",prop:"BloodTypeCode"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.BloodTypeCode,t.dictData.BloodTypeModel)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{staticClass:"rh",attrs:{label:"RH",prop:"RH"}},[i("p",[t._v(t._s(t.commonObj.RH))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"主刀医生",prop:"MianDoctorId "}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.MianDoctorId,t.doctorList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"指导医师",prop:"InstructDoctorId "}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.InstructDoctorId,t.doctorList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"手术一助",prop:"FirstAssistantId"}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.FirstAssistantId,t.doctorList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"手术二助",prop:"SecondAssistantId"}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.SecondAssistantId,t.doctorList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"麻醉医师",prop:"AnesthesiaDoctorId "}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.AnesthesiaDoctorId,t.doctorList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"麻醉助手",prop:"AnesthesiaAssistantId "}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.AnesthesiaAssistantId,t.doctorList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"麻醉方式",prop:"AnesthesiaType"}},[i("p",[t._v(t._s(t._f("publicFilter")(t.commonObj.AnesthesiaType,t.dictData.OperationAnesthesia)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"麻醉时间",prop:"AnesthesiaTime"}},[i("p",[t._v(t._s(t._f("timeFilter")(t.commonObj.AnesthesiaTime)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"巡回护士",prop:"CircuitNurseId"}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.CircuitNurseId,t.nurseList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"机械护士",prop:"InstrumentNurseId"}},[i("p",[t._v(t._s(t._f("userFilter")(t.commonObj.InstrumentNurseId,t.nurseList)))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"异物置入物",prop:"ForeignBodyImplants"}},[i("p",[t._v(t._s(t.commonObj.ForeignBodyImplants))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"多重耐药菌",prop:"MDRO"}},[i("p",[t._v(t._s(t.commonObj.MDRO))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"乙肝",prop:"HBV"}},[i("p",[t._v(t._s(t.commonObj.HBV))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"丙肝",prop:"HCV"}},[i("p",[t._v(t._s(t.commonObj.HCV))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"梅毒",prop:"RPR"}},[i("p",[t._v(t._s(t.commonObj.RPR))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"艾滋",prop:"HIV"}},[i("p",[t._v(t._s(t.commonObj.HIV))])])],1),i("div",{staticClass:"item"},[i("el-form-item",{attrs:{label:"申请时间",prop:"ApplyTime"}},[i("p",[t._v(t._s(t._f("timeFilter")(t.commonObj.ApplyTime)))])])],1)]),i("div",{staticClass:"remark"},[i("el-form-item",{attrs:{label:"说明",prop:"Description"}},[i("p",[t._v(t._s(t.commonObj.Description))])])],1),i("div",{staticClass:"remark"},[i("el-form-item",{attrs:{label:"备注",prop:"Remark"}},[i("p",[t._v(t._s(t.commonObj.Remark))])])],1),t._t("default")],2)],1)},p=[],m=i("2909"),u=(i("6762"),i("ac6a"),i("d634")),d={data:function(){return{planData:[],dictData:{BloodTypeModel:[],OperationAnesthesia:[],OperationHumanBody:[],OperationHumanPosition:[],OperationIncisionLevel:[],OperationLevel:[],OperationRoom:[],OperationType:[]},doctorList:[],nurseList:[]}},props:{commonObj:{type:Object,required:!0}},watch:{commonObj:{handler:function(t,e){console.log(t),this.getKeyName(1),this.getKeyName(2)},immediate:!0,deep:!0}},created:function(){var t=this;this.$Api.getOperationD({}).then(function(e){console.log(e),e.Status&&(t.planData=e.Data)}),this.$Api.getOperationOtherD({}).then(function(e){e.Status&&(t.dictData=e.Data,console.log(e.Data))})},methods:{getKeyName:function(t){var e=this,i=1===t?u["i"]:u["r"],a=[];i.forEach(function(t){e.commonObj[t]&&!a.includes(e.commonObj[t])&&a.push(e.commonObj[t])}),a.forEach(function(i){e[1===t?"getDoctorUser":"getNurseList"](i,2)})},getDoctorUser:function(t){var e=this;t=t?{content:t,t:+new Date}:{},this.$Api.getDoctorUser(t).then(function(t){if(t.Status){var i,a=t.Data||[];(i=e.doctorList).push.apply(i,Object(m["a"])(a))}})},getNurseList:function(t){var e=this;t=t?{content:t}:{},this.$Api.getNurseList(t).then(function(t){if(t.Status){var i,a=t.Data||[];(i=e.nurseList).push.apply(i,Object(m["a"])(a))}})}}},b=d,h=(i("b57b"),i("2877")),f=Object(h["a"])(b,c,p,!1,null,"07d0a652",null),O=f.exports,v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-table",{attrs:{data:t.tableData,height:"90%"},on:{"row-click":t.selectOne}},[i("el-table-column",{attrs:{label:"申请单",prop:"Index",width:"80"}}),i("el-table-column",{attrs:{label:"状态",prop:"Status",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"status"},[i("span",{staticClass:"bg",class:"bg"+e.row.Status},[t._v(t._s(t._f("statusFilter")(e.row.Status,1,t.statusOptions)))])])]}}])}),i("el-table-column",{attrs:{label:"手术项目",prop:"OperationName"}}),i("el-table-column",{attrs:{label:"手术类型",prop:"OperationTypeName"}}),i("el-table-column",{attrs:{label:"主刀医师",prop:"MianDoctorName"}}),i("el-table-column",{attrs:{label:"手术室",prop:"OperationRoomName"}}),i("el-table-column",{attrs:{label:"申请医师",prop:"ApplyUserName",width:"100"}}),i("el-table-column",{attrs:{label:"申请时间",prop:"ApplyTime"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("timeFilter")(e.row.ApplyTime)))]}}])}),i("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("dd",null,{scope:e})]}}])})],1)},I=[],_={name:"operationTable",data:function(){return{statusOptions:u["D"]}},props:{tableData:{type:Array,default:function(){}},callback:{type:Function,default:function(){}}},methods:{selectOne:function(t){this.callback(t)}}},g=_,D=(i("5f92"),Object(h["a"])(g,v,I,!1,null,"17d49d2a",null)),y=D.exports,w=i("6e86"),T=i("c9b7"),S=i("98ad"),C=i("3943"),j={data:function(){return{operationId:"",orderId:"",isReset:!0,tableData:[],commonObj:{},nowTemp:"newOperation",tabsTemp:[{Text:"新建手术",Value:"newOperation",Show:!0},{Text:"手术记录",Value:"historyOperation",Show:!0}],historyListData:[],isFooter:!0,timer:null,caSignOperation:{},currentObjData:""}},components:{newOperation:r["a"],operationDeatil:O,operationTable:y,historyList:w["a"],myAlter:S["a"]},watch:{"patientMsg.Status":{handler:function(t){var e=this;8===t?(this.tabsTemp[0].Show=!1,this.nowTemp="historyOperation",this.$Api.getHistoryOperation({patientId:this.patientMsg.PatientId}).then(function(t){t.Status&&(e.historyListData=t.Data||[],e.$nextTick(function(){e.historyListData.length>0&&(e.$refs.historyList.selectId=e.historyListData[0].InHospitalId,e.historyListData[0].InHospitalId&&e.getHistoryDetail(e.historyListData[0].InHospitalId))}))})):(this.tabsTemp[0].Show=!0,this.nowTemp="newOperation")},deep:!0,immediate:!0},isGetCA:function(t){t&&this.currentObjData.Data&&"手术申请"==this.currentObjData.Data[0].Name&&this.caSignOperation.checkData(this.user.UserInfo,this.currentObjData)}},created:function(){this.isSignName&&(this.caSignOperation=new C["a"](this,this.signName))},computed:Object(n["a"])({},Object(l["b"])({patientMsg:"public/GET_PATIENTMSG",isShow:"public/GET_ISSHOW",isRegister:"configuration/GET_ISREGISTER",signName:"public/GET_SIGNNAME",isSignName:"public/GET_ISSIGNNAME",isGetCA:"public/GET_ISGETCA",user:"public/GET_USER",caImgData:"public/GET_CAIMGDATA"})),methods:{print:function(t){clearTimeout(this.timer);var e=(new Date).getTime(),i=window.location.protocol+"\\"+window.location.host,a="".concat(URLCONFIG.Emr,"/Nursing/EditPage.aspx?patientId=").concat(this.patientMsg.PatientId,"&inHouseId=").concat(this.patientMsg.InHouseId,"&areaType=").concat(this.patientMsg.AreaType,"&createUser=940c7df7-a718-e911-80cd-0050568e1b08&originUrl=").concat(i,"&objectType=").concat(u["x"].operation.objectType,"&logUserEditTrack=true&documentId=f2f201db-3ca2-47b0-ba81-ab6b0096abd6&mark=true&templateId=").concat(u["x"].operation.templateId,"&operationid=").concat(t.FormId,"&areaId=").concat(this.patientMsg.AreaId,"&t=").concat(e);console.log(a),this.$store.commit("public/SET_PRINTIFRAMEURL",a)},tapsExamine:function(t){var e=this;console.log(t),"historyOperation"===t&&this.$Api.getHistoryOperation({patientId:this.patientMsg.PatientId}).then(function(t){t.Status&&(e.historyListData=t.Data||[],e.$nextTick(function(){e.historyListData.length>0&&(e.$refs.historyList.selectId=e.historyListData[0].InHospitalId,e.historyListData[0].InHospitalId&&e.getHistoryDetail(e.historyListData[0].InHospitalId))}))})},getHistoryDetail:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$route.query.id;this.$Api.getHistoryDetail({inHospitalId:e||this.patientMsg.InHouseId}).then(function(e){if(e.Status){for(var i=0;i<e.Data.length;i++)e.Data[i]["Index"]=i+1;t.tableData=e.Data}})},save:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){var i,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log(1111),this.isFooter=!0,t.next=4,e();case 4:i=t.sent,console.log("data",i),i&&this.$Api.postOperationData(i).then(function(t){console.log(t),t.Status&&(a.commonObj=i,a.operationId=t.Data.FormId,a.orderId=t.Data.OrderId,a.$store.commit("public/SET_ISSHOW",!0))});case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),upData:function(){this.commonObj.Id=this.operationId,this.$store.commit("public/SET_ISSHOW",!1),this.nowTemp="newOperation"},submitData:function(){if(this.patientMsg.RegistId)if(this.isSignName){var t={Type:"0",Data:[{Name:"手术申请"}],No:this.user.UserInfo.No,UserName:this.user.UserInfo.Name};this.currentObjData=t,this.caSignOperation.KeyVerify()}else this.handleOperation();else if(this.$msg.info("该患者无有效挂号，请先挂号！"),"1"===this.isRegister){var e={title:"患者挂号",width:"800px",component:"registrationAlter",isShowFooter:!0,btn:["挂号","取消"],visible:!0};this.$store.commit("public/SET_DIALOGDATA",e)}},handleOperation:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$IMIS.submmitOrderIMIS([{OrderId:this.orderId,OrderType:1}],this.patientMsg);case 3:if(e=t.sent,e){t.next=6;break}return t.abrupt("return");case 6:t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:this.$Api.submitAdvice({InHouseId:this.$route.query.id||this.patientMsg.InHouseId,OrderList:[this.orderId],HisRegisterId:this.patientMsg.RegistId,CASignImg:this.caImgData}).then(function(t){if(i.$msg[t.Status?"success":"warning"](t.Message),t.Status){var e={FormId:t.Data.FormIds[0]};i.print(e),i.reset(),i.$store.commit("public/SET_ISSHOW",!1),i.$refs.historyList&&i.$refs.historyList.selectId&&i.getHistoryDetail(i.$refs.historyList.selectId)}else i.refreshOrderStatus()}).catch(function(t){i.refreshOrderStatus()});case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(){return t.apply(this,arguments)}return e}(),reset:function(){var t=this;this.isReset=!1,this.commonObj={},this.$nextTick(function(){t.isReset=!0})},showTable:function(t){var e=this;console.log(t),this.$Api.getOperationOneData({formId:t.FormId}).then(function(t){if(t.Status){var i=t.Data;i.Id="00000000-0000-0000-0000-000000000000",i.ExpectOperationTime=i.ApplyTime=Object(T["a"])(),e.commonObj=i,e.nowTemp="newOperation",console.log(e.commonObj)}})},alterCallback:function(t){"newOperation"==this.nowTemp?this.commonObj.Id=this.operationId:this.reset(),this.$store.commit("public/SET_ISSHOW",!1)},historyItem:function(t){this.getHistoryDetail(t)},getOperationOneData:function(t){var e=this;this.$Api.getOperationOneData({formId:t}).then(function(t){t.Status&&(e.commonObj=t.Data,e.$store.commit("public/SET_ISSHOW",!0))})},lookReport:function(t){console.log(t)},selectRow:function(t){console.log(t),this.operationId=t.FormId,this.orderId=t.OrderId,this.getOperationOneData(t.FormId),1===t.Status?this.isFooter=!0:this.isFooter=!1},refreshOrderStatus:function(){this.$Api.refreshOrderStatus({inHospitalId:this.$route.query.id||this.patientMsg.InHouseId}).then(function(t){})}}},A=j,L=(i("e4f9"),Object(h["a"])(A,a,s,!1,null,"2bd4ff41",null));e["default"]=L.exports},"5f92":function(t,e,i){"use strict";var a=i("3d22"),s=i.n(a);s.a},"71f9":function(t,e,i){},b57b:function(t,e,i){"use strict";var a=i("71f9"),s=i.n(a);s.a},e4f9:function(t,e,i){"use strict";var a=i("3008"),s=i.n(a);s.a}}]);
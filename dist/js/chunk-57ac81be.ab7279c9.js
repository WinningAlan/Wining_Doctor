(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57ac81be"],{"1b51":function(e,t,a){"use strict";var s,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-reference-alter"},[a("div",{staticClass:"cl"},[a("el-radio-group",{attrs:{fill:"#0071E7"},model:{value:e.alterData.activeName,callback:function(t){e.$set(e.alterData,"activeName",t)},expression:"alterData.activeName"}},e._l(e.alterData.list,function(t,s){return a("el-radio-button",{key:s,attrs:{label:t.value}},[e._v(e._s(t.text))])}),1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.alterData.activeName,expression:"alterData.activeName===1"}],staticClass:"name-left"},[a("span",[e._v("引用内容")]),a("el-select",{attrs:{placeholder:"请选择引用内容",multiple:"",filterable:"","collapse-tags":"","default-first-option":""},model:{value:e.referName,callback:function(t){e.referName=t},expression:"referName"}},e._l(e.referList,function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})}),1)],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoading,expression:"showLoading"}],staticClass:"data-reference-table",attrs:{"element-loading-text":"拼命加载中..."}},[a("submitTable",{directives:[{name:"show",rawName:"v-show",value:1===e.alterData.activeName,expression:"alterData.activeName===1"}],key:"1",staticStyle:{"margin-top":"0",width:"1254px"},attrs:{tableData:e.diagnosticRecordsData,type:10,options:e.options,"row-key":"Id"},on:{"selection-change":e.selectionChange}}),a("doctor-advice-list",e._b({directives:[{name:"show",rawName:"v-show",value:2===e.alterData.activeName,expression:"alterData.activeName===2"}],ref:"reference",staticClass:"reference",attrs:{tableData:e.submitData,isQuote:!0},on:{"selection-change":e.selectionChange}},"doctor-advice-list",e.filters,!1,!0)),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:3===e.alterData.activeName,expression:"alterData.activeName===3"}],key:"3",staticStyle:{"margin-top":"0",width:"1254px"},attrs:{tableData:e.inspectionResultData,isSelect:!0,"row-key":function(e){return e.ItemCode+e.ApplyId},columns:e.inspectionResultColumns},on:{"selection-change":e.selectionChange}}),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:4===e.alterData.activeName,expression:"alterData.activeName===4"}],key:"4",ref:"testResult",staticClass:"testResult",staticStyle:{"margin-top":"0",width:"1254px"},attrs:{tableData:e.testResultData,isSelect:!0,"row-key":"ReportNo","expand-row-keys":e.expandRow,columns:e.testResultColumns},on:{"selection-change":e.selectionChange,select:e.select,"select-all":e.selectAll},scopedSlots:e._u([{key:"CrisisFlag",fn:function(t){var s=t.scope;return a("span",{class:{red:s.row.CrisisFlag}},[e._v(e._s(s.row.CrisisFlag?"危机":"正常"))])}}])},[a("el-table-column",{attrs:{slot:"expand",type:"expand",label:"检验报告",width:"80"},slot:"expand",scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.listTestDetail.length?a("simpleTable",{ref:t.row.ReportNo,staticStyle:{"margin-top":"0",width:"1254px"},attrs:{tableData:t.row.listTestDetail,isSelect:!0,"row-key":"ItemCode",indexLable:"序号",columns:e.testDetailColumns},on:{"selection-change":function(a){e.detailChange(t.row.ItemCode,a)}}}):a("p",{staticStyle:{"text-align":"center"}},[e._v("暂无报告")])]}}])})],1),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:5===e.alterData.activeName,expression:"alterData.activeName===5"}],key:"5",staticStyle:{"margin-top":"0",width:"1254px"},attrs:{tableData:e.nursingRecordData,isSelect:!0,"row-key":"Id",columns:e.nursingRecordColumns},on:{"selection-change":e.selectionChange}}),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:6===e.alterData.activeName,expression:"alterData.activeName===6"}],key:"6",staticStyle:{"margin-top":"0",width:"1254px"},attrs:{tableData:e.signsRecordData,isSelect:!0,"row-key":"Id",columns:e.signsRecordColumns},on:{"selection-change":e.selectionChange}}),a("div",{directives:[{name:"show",rawName:"v-show",value:7===e.alterData.activeName,expression:"alterData.activeName===7"}],key:"7",staticClass:"table-warp"},[a("el-radio-group",{staticClass:"formula-left",on:{change:e.getAllergy},model:{value:e.allergyType,callback:function(t){e.allergyType=t},expression:"allergyType"}},e._l(e.allergyOption,function(t,s){return a("el-radio-button",{key:s,attrs:{label:t.value}},[e._v(e._s(t.text))])}),1),a("div",{staticClass:"formula-right"},[a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:1===e.allergyType,expression:"allergyType===1"}],staticStyle:{"margin-top":"0"},attrs:{tableData:e.allergyData,isSelect:!0,"row-key":"Id",columns:e.drugColumns},on:{"selection-change":e.selectionChange}}),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:2===e.allergyType,expression:"allergyType===2"}],staticStyle:{"margin-top":"0"},attrs:{tableData:e.allergyData,isSelect:!0,"row-key":"Id",columns:e.foodColumns},on:{"selection-change":e.selectionChange}}),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:3===e.allergyType,expression:"allergyType===3"}],staticStyle:{"margin-top":"0"},attrs:{tableData:e.allergyData,isSelect:!0,"row-key":"Id",columns:e.takeColumns},on:{"selection-change":e.selectionChange}}),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:4===e.allergyType,expression:"allergyType===4"}],staticStyle:{"margin-top":"0"},attrs:{tableData:e.allergyData,isSelect:!0,"row-key":"Id",columns:e.elseColumns},on:{"selection-change":e.selectionChange}}),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:5===e.allergyType,expression:"allergyType===5"}],staticStyle:{"margin-top":"0"},attrs:{tableData:e.allergyData,isSelect:!0,"row-key":"Id",columns:e.untowardColumns},on:{"selection-change":e.selectionChange}}),a("simpleTable",{directives:[{name:"show",rawName:"v-show",value:6===e.allergyType,expression:"allergyType===6"}],staticStyle:{"margin-top":"0"},attrs:{tableData:e.allergyData,isSelect:!0,"row-key":"Id",columns:e.historyColumns},on:{"selection-change":e.selectionChange}})],1)],1)],1),a("p",{staticClass:"alter-button"},[e._t("close"),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.insert(e.selectData[e.alterData.activeName],e.alterData.activeName)}}},[e._v("引用")])],2)])},i=[],o=(a("456d"),a("7f7f"),a("a481"),a("8615"),a("2909")),r=(a("ac6a"),a("6762"),a("2fdb"),a("be94")),l=a("ade3"),c=a("f1ed"),u=a("33ae"),g=a("1b47"),h=a("2e7f"),d=a("2f62"),p=a("c9b7"),m=a("d634"),f=(s={"体温":"°C","脉搏":"次/分","心率":"次/分","呼吸":"次/分"},Object(l["a"])(s,"呼吸","次/分"),Object(l["a"])(s,"血压","mmHg"),Object(l["a"])(s,"血氧","%"),Object(l["a"])(s,"出量值","ml"),Object(l["a"])(s,"入量值","ml"),Object(l["a"])(s,"瞳孔大小左","mm"),Object(l["a"])(s,"瞳孔大小右","mm"),Object(l["a"])(s,"意识",""),Object(l["a"])(s,"病情记录",""),s),v={name:"dataReferenceAlter",components:{doctorAdviceList:c["a"],simpleTable:u["a"],submitTable:g["a"]},props:{alterData:{type:Object,required:!0}},created:function(){var e=this;console.log(this.alterData,"传递数据"),this.$Api.getDiagnoseType({}).then(function(t){e.options=t.Data||[]})},computed:Object(r["a"])({},Object(d["b"])({patientMsg:"public/GET_PATIENTMSG"}),{submitData:function(){var e=this;return this.doctorAdviceListData.filter(function(t,a){return t._index=a,e.filters.statusChecked.includes(1===t.EffectiveTime&&5===t.Status?-t.Status:t.Status)&&e.filters.effectiveChecked.includes(t.EffectiveTime)})},expandRow:function(){console.log(this.testResultData,"检验详细数据");var e=[];return this.testResultData.forEach(function(t){t.listTestDetail.length&&e.push(t.ReportNo)}),e}}),watch:{alterData:{handler:function(e){var t=e.activeName;switch(this.showLoading=!0,t){case 1:this.getDiagnoseList();break;case 2:this.getAdviceList();break;case 3:this.getReportResultList(1);break;case 4:this.getReportResultList(2);break;case 5:this.getNursingRecord();break;case 6:this.getTrigeRecord();break;case 7:this.allergyType=1,this.getAllergy(1);break}console.log(e.activeName,"activeName")},immediate:!0,deep:!0}},data:function(){return{filters:{statusChecked:[2,3,4,5,-5,6,7],effectiveChecked:[1,2]},allergyType:1,allergyOption:m["b"],allergyData:[],drugColumns:h["b"],foodColumns:h["e"],takeColumns:h["q"],elseColumns:h["d"],untowardColumns:h["v"],historyColumns:h["g"],options:[],selectData:{},selectAllergy:{},detailChecked:{},doctorAdviceListData:[],inspectionResultColumns:h["i"],inspectionResultData:[],testResultColumns:h["t"],testDetailColumns:h["r"],testResultData:[],diagnosticRecordsData:[],signsRecordColumns:h["p"],signsRecordData:[],nursingRecordColumns:h["l"],nursingRecordData:[],referList:[{text:"诊断内容",value:"DiagnosisName"},{text:"ICD编码",value:"ICDCode"}],referName:["DiagnosisName"],showLoading:!1}},methods:{getAllergy:function(e){switch(e){case 1:this.getMedicine();break;case 2:this.getFoodAllergy();break;case 3:this.getContrasAllergy();break;case 4:this.getOtherAllergy();break;case 5:this.getDrugList();break;case 6:this.getAllergyHistories();break}},getMedicine:function(){var e=this;this.$Api.getMedicine({InHouseId:this.$route.query.id||this.alterData.inHouseId}).then(function(t){e.showLoading=!1,e.allergyData=t.Data||[],!t.Status&&e.$msg.warning(t.Message)})},getContrasAllergy:function(){var e=this;this.$Api.getContrasAllergy({InHouseId:this.$route.query.id||this.alterData.inHouseId}).then(function(t){e.showLoading=!1,e.allergyData=t.Data||[],!t.Status&&e.$msg.warning(t.Message)})},getFoodAllergy:function(){var e=this;this.$Api.getFoodAllergy({InHouseId:this.$route.query.id||this.alterData.inHouseId}).then(function(t){e.showLoading=!1,e.allergyData=t.Data||[],!t.Status&&e.$msg.warning(t.Message)})},getOtherAllergy:function(){var e=this;this.$Api.getOtherAllergy({InHouseId:this.$route.query.id||this.alterData.inHouseId}).then(function(t){e.showLoading=!1,e.allergyData=t.Data||[],!t.Status&&e.$msg.warning(t.Message)})},getDrugList:function(){var e=this;this.$Api.getDrugList({InHouseId:this.$route.query.id||this.alterData.inHouseId}).then(function(t){e.showLoading=!1,e.allergyData=t.Data||[],!t.Status&&e.$msg.warning(t.Message)})},getAllergyHistories:function(){var e=this;this.$Api.getAllergyHistories({patientId:this.patientMsg.PatientId||this.alterData.PatientId}).then(function(t){e.showLoading=!1,e.allergyData=t.Data||[],!t.Status&&e.$msg.warning(t.Message)})},selectAll:function(e){var t=this,a=e.length?e:this.testResultData.filter(function(e){return e.listTestDetail.length});a.forEach(function(e){t.$refs.testResult.$children[0].toggleRowExpansion(e,!0)}),this.$nextTick(function(){a.forEach(function(a){t.$refs[a.ReportNo]&&t.$refs[a.ReportNo].$children[0][e.length?"toggleAllSelection":"clearSelection"]()})})},select:function(e,t){var a=this;console.log(e,t,"select"),this.$refs.testResult.$children[0].toggleRowExpansion(t,!0);var s=this.isChecked(e,t.ReportNo);this.$nextTick(function(){a.$refs[t.ReportNo]&&a.$refs[t.ReportNo].$children[0][s?"toggleAllSelection":"clearSelection"]()})},isChecked:function(e,t){var a=!1;return e.forEach(function(e){e.ReportNo===t&&(a=!0)}),a},detailChange:function(e,t){this.detailChecked[e]=t,console.log(e,t)},insert:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0;if(7===this.alterData.activeName&&(t=this.selectAllergy[this.allergyType]),4===this.alterData.activeName){var s=Object(o["a"])(Object.values(this.detailChecked));t=s}if(!t.length)return this.$msg.info("未选中需要引用的数据！");var n=document.getElementById("medicalNow"),i="";switch(a){case 1:t.forEach(function(t){var a=e.referName.length?Object(o["a"])(e.referName):[e.referList[0].value];a.forEach(function(e,s){return a[s]=t[e]}),i+="".concat(a.join(" "),"；")});break;case 2:i=this.getAdviceStr(t);break;case 3:t.forEach(function(e){i+="".concat(e.Content,"；")});break;case 4:i=this.getTestStr();break;case 5:case 6:t.forEach(function(e){i+="".concat(e.Content,"；")});break;case 7:t.forEach(function(t){i+="".concat(1==e.allergyType||5==e.allergyType?t.MedicineName:t.Name,",").concat(5==e.allergyType?t.SeverityTypeDesc:6==e.allergyType?t.AllergyType:t.AllergyTypeDesc,"；")});break}if(i=i.substring(0,i.length-1),i=i.replace(/null;/g,"").replace(/null；/g,"").replace(/null/g,"").replace(/undefined/g,"").replace(/undefined;/g,"").replace(/undefined；/g,""),this.alterData.inHouseId)return i=i.replace(/&nbsp;/g,"").replace(/<\/?p[^>]*>/gi,"").replace(/[┏│┗]/g).replace(/undefined/g,""),this.alterData.insertContent=i,void(this.alterData.visible=!1);i=i.replace(/<\/p[^>]*>/gi,"<br>"),i=i.replace(/<p[^>]*>/gi,""),i&&n.contentWindow.postMessage({type:"insertHtml",msg:i},window.URLCONFIG.Emr),console.log(i)},getTestStr:function(){var e="";return Object.values(this.detailChecked).forEach(function(t){var a="";t.forEach(function(e){a+="".concat(e.ItemName,":").concat(e.ItemValue).concat(e.Unit,"，")}),e+="".concat(a.substring(0,a.length-1),"；")}),e},getAdviceStr:function(e){var t=this,a="",s="";return e.forEach(function(e){var n=e.OrderType;switch(n){case 15:a+="".concat(e.OrderContent,"；");break;case 1:case 0:case 5:case 3:case 122:case 31:a+="".concat(e.OrderContent,"&nbsp; ").concat(e.FrequencyText,"&nbsp;；");break;case 4:s="";var i="";e.BloodTypeName&&(i="<span>".concat(e.BloodTypeName,"&nbsp;RH<sup>").concat("阳性"===e.RH?"+":"-","</sup> </span>")),e.OrderDetails.forEach(function(e){s+="<p>".concat(i).concat(e.ItemName,"&nbsp;").concat(e.Count," ").concat(e.Unit," 静滴&nbsp;ST</p>")}),a+="".concat(s," ");break;case 7:case 8:s="",e.OrderDetails.forEach(function(e){s+="<p>".concat(e.DictItemName,"</p>")}),a+="".concat(s," ");break;case 14:s="",e.OrderDetails.forEach(function(e){var a=t.getgroupStr(e);s+="".concat(a).concat(e.Insurance).concat(e.SpecialName&&"普通"!==e.SpecialName?"["+e.SpecialName+"]":"").concat(e.MedicineName,"&nbsp; ").concat(e.Dose).concat(e.Unit).concat(e.GroupNumber===e.GroupCount?"":"</p>")}),a+="".concat(s,"&nbsp; ").concat(e.UsageText,"&nbsp; ").concat(e.FrequencyText).concat(e.OrderDays?"&nbsp; "+e.OrderDays+"天":"","</p> ");break}}),console.log(a),a},getTrigeRecord:function(){var e=this;this.$Api.getTrigeRecord({inHouseId:this.$route.query.id||this.alterData.inHouseId}).then(function(t){if(e.showLoading=!1,t.Status){var a=JSON.parse(t.Data)||{},s="";s+=a.Temp?"体温:".concat(a.Temp<35?"体温不升":a.Temp+"°C","，"):"",s+=a.HeartRate?"心率:".concat(a.HeartRate,"次/分，"):"",s+=a.Breath?"呼吸:".concat(a.Breath,"次/分，"):"",s+=a.SBP?"血压:".concat(a.SBP,"/").concat(a.SDP,"mmHg，"):"",s+=a.SPO2?"血氧:".concat(a.SPO2,"%，"):"",a.Content=s.substring(0,s.length-1),e.signsRecordData=[a],console.log(a)}else e.$msg.warning(t.Message)})},getNursingRecord:function(){var e=this;this.$Api.getNursingRecord({inHouseId:this.$route.query.id||this.alterData.inHouseId,startTime:"medicalHistory"==this.$route.name?this.patientMsg.InHospTime:this.alterData.InHospTime,endTime:Object(p["a"])()}).then(function(t){if(e.showLoading=!1,t.Status){var a=JSON.parse(t.Data)||[];console.log(a),a=a.filter(function(e,t){e.Id=t;var a="";return e.Time=e["日期"]+" "+e["时间"],Object.keys(f).forEach(function(t){e[t]&&("ml"===f[t]?a+="".concat("入量值"===t?e["入量项目"]:e["出量项目"],":").concat(e[t]).concat(f[t],"，"):a+="".concat(t,":").concat(e[t]).concat(f[t],"，"))}),e.Content=a.substring(0,a.length-1),e["护士签名"]}),console.log(a),e.nursingRecordData=a}else e.$msg.warning(t.Message)})},getDiagnoseList:function(){var e=this;this.$Api.getHistoryDiagnoseList({inHouseId:this.$route.query.id||this.alterData.inHouseId}).then(function(t){e.showLoading=!1,t.Status&&(console.log(t.Data),e.diagnosticRecordsData=t.Data||[])})},selectionChange:function(e){console.log(e),7===this.alterData.activeName?this.selectAllergy[this.allergyType]=e:this.selectData[this.alterData.activeName]=e},getAdviceList:function(){var e=this;this.$Api.getAdviceList({inHouseId:this.$route.query.id||this.alterData.inHouseId,orderStatus:2}).then(function(t){e.showLoading=!1,e.doctorAdviceListData=t.Data||[]})},getReportResultList:function(e){var t=this,a={HisPatientId:this.alterData.HISPatientId,ReportType:e};this.$Api.getReportResultList(a).then(function(a){t.showLoading=!1,console.log(a),a.Status&&(1===e&&a.Data.forEach(function(e){var t="";e.listCheckDetail&&e.listCheckDetail.forEach(function(e){"检查结论"===e.ItemName&&(t+="".concat(e.ItemValue,"，"))}),e.Content=t.substring(0,t.length-1)}),t[1===e?"inspectionResultData":"testResultData"]=a.Data||[])})},getgroupStr:function(e){var t="<p>";return 1===e.GroupCount?t:(1===e.GroupNumber?t+="┏":e.GroupNumber===e.GroupCount?t+="┗":t+="│",t)}}},y=v,D=(a("aa8a"),a("2877")),b=Object(D["a"])(y,n,i,!1,null,null,null);t["a"]=b.exports},"504c":function(e,t,a){var s=a("0d58"),n=a("6821"),i=a("52a7").f;e.exports=function(e){return function(t){var a,o=n(t),r=s(o),l=r.length,c=0,u=[];while(l>c)i.call(o,a=r[c++])&&u.push(e?[a,o[a]]:o[a]);return u}}},8615:function(e,t,a){var s=a("5ca1"),n=a("504c")(!1);s(s.S,"Object",{values:function(e){return n(e)}})},9959:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var s={visible:!1,name:"数据引用",activeName:1,insertContent:"",width:"1300px",components:"dataReferenceAlter",btn:[],list:[{text:"诊断记录",value:1},{text:"医嘱记录",value:2},{text:"检查结果",value:3},{text:"检验结果",value:4},{text:"过敏信息",value:7}]}},aa8a:function(e,t,a){"use strict";var s=a("c0c9"),n=a.n(s);n.a},c0c9:function(e,t,a){}}]);
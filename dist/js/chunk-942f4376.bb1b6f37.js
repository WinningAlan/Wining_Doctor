(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-942f4376"],{"386d":function(e,t,a){"use strict";var n=a("cb7c"),i=a("83a1"),s=a("5f1b");a("214f")("search",1,function(e,t,a,o){return[function(a){var n=e(this),i=void 0==a?void 0:a[t];return void 0!==i?i.call(a,n):new RegExp(a)[t](String(n))},function(e){var t=o(a,e,this);if(t.done)return t.value;var c=n(e),l=String(this),r=c.lastIndex;i(r,0)||(c.lastIndex=0);var u=s(c,l);return i(c.lastIndex,r)||(c.lastIndex=r),null===u?-1:u.index}]})},"5abb":function(e,t,a){"use strict";var n=a("f6ff"),i=a.n(n);i.a},"67ed":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"caseControl"},[n("div",{staticClass:"caseControlHead"},[n("div",{staticClass:"left"},[n("div",[n("span",[e._v("入院日期")]),n("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions,"value-format":" yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm"},on:{change:e.search},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}})],1),n("div",[n("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择诊疗区"},on:{change:e.handleSelArea},model:{value:e.selectAreas,callback:function(t){e.selectAreas=t},expression:"selectAreas"}},e._l(e.options,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.value}})}),1)],1),n("div",[n("el-select",{attrs:{multiple:"",remote:"",filterable:"",size:"small","collapse-tags":"",placeholder:"请选择首诊医生","remote-method":e.selectDoct,"default-first-option":"","reserve-keyword":""},on:{focus:function(t){e.selectDoct("")},change:e.search},model:{value:e.FirstDoctorIds,callback:function(t){e.FirstDoctorIds=t},expression:"FirstDoctorIds"}},e._l(e.doctorList,function(e){return n("el-option",{key:e.Id,attrs:{label:e.Name,value:e.Id}})}),1)],1),n("div",[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"姓名/患者ID/病历号/卡号",clearable:""},model:{value:e.patMessage,callback:function(t){e.patMessage=t},expression:"patMessage"}},[n("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.cardType,callback:function(t){e.cardType=t},expression:"cardType"}},e._l(e.cardList,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.value}})}),1)],1)],1),n("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1),n("div",{staticClass:"right"},[n("el-tooltip",{attrs:{content:"导出",placement:"top",effect:"light"}},[n("img",{attrs:{src:a("7e71")},on:{click:e.exportData}})]),n("el-popover",{staticStyle:{minWidth:"0"},attrs:{placement:"bottom",width:"99","popper-class":"newProp"},model:{value:e.columnSet,callback:function(t){e.columnSet=t},expression:"columnSet"}},[n("div",{staticClass:"checkContent"},[n("el-checkbox",{on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._l(e.columnsAll,function(t,a){return n("el-checkbox",{key:a,attrs:{label:t.Code},model:{value:t.Ifcover,callback:function(a){e.$set(t,"Ifcover",a)},expression:"item.Ifcover"}},[e._v(e._s(t.Name))])})],2),n("div",{staticClass:"columnBtn"},[n("span",{on:{click:function(t){e.columnSet=!1}}},[e._v("取消")]),n("span",{on:{click:e.saveConfig}},[e._v("确定")])]),n("el-tooltip",{attrs:{slot:"reference",placement:"top",effect:"light",content:"自定义配置"},slot:"reference"},[n("img",{attrs:{src:a("bd5a")}})])],1)],1)]),n("div",{staticClass:"caseControlContent"},[n("pat-message-table",{attrs:{getPatientList:e.getPatientList,columns:e.columns,defaultColumns:e.defaultColumns,router:"caseControl",height:e.height},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.scope;return[n("el-button",{attrs:{type:"text"},on:{click:function(t){e.gotoDetail(a.row)}}},[e._v("查看")]),n("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.callbackPatient(a.row)}}},[e._v("召回")])]}}])}),0!=e.totalPage?n("div",{staticClass:"pageStyle"},[n("div",{staticClass:"pageNum"},[n("el-pagination",{attrs:{background:"","current-page":e.pageIndex,"page-sizes":[10,20,30,40],"page-size":10,layout:"sizes, prev, pager, next",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pageIndex=t}}})],1)]):e._e()],1),n("my-alter",{attrs:{title:"患者召回",visible:e.dialogData.visible||!1,isfooter:!0,width:"480px",callback:e.closeDialog}},[n("callback-pat",{ref:"content",attrs:{initialize:e.dialogData.visible}})],1)],1)},i=[],s=a("be94"),o=(a("f751"),a("ac6a"),a("386d"),a("96cf"),a("1da1")),c=(a("a481"),a("d634")),l=a("240f"),r=a("c9b7"),u=a("2f62"),h=a("e5fd"),g=a("98ad"),p={components:{patMessageTable:l["a"],callbackPat:h["a"],myAlter:g["a"]},name:"caseControl",data:function(){return{totalPage:0,pageIndex:1,pageSize:10,columnsAll:"",patMessage:"",checkAll:!1,columnSet:!1,timeRange:[,],selectAreas:[0],FirstDoctorIds:[],doctorList:[],cardType:3,cardList:c["g"],columns:[],defaultColumns:[{prop:"Prognosis",label:"转归",width:"70px",children:[]},{prop:"TriageLevel",label:"分级",width:"60px",children:[]},{prop:"PatientName",label:"患者基本信息",minWidth:"140",children:[]}],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},showLoading:!1,height:400}},created:function(){this.height=parseInt(document.body.clientHeight-210),this.debouceElg=Object(r["g"])(this.getPatientList,500),this.blobArr=[],console.log("创建"),this.timeRange[0]=Object(r["a"])(null,new Date((new Date).getTime()-6048e5)),this.timeRange[1]=Object(r["a"])(),console.log(this.timeRange,"时间范围"),this.getTableConfig(),this.getPatientList(),this.$store.commit("public/SET_PATIENTTABLELIST",[])},methods:{selectDoct:function(e){e=e&&e.replace(/(^\s*)|(\s*$)/g,""),this.getDoctorList(e)},getDoctorList:function(e){var t=this;e=""==e?null:e;var a={content:e};this.$Api.getDoctorList(a).then(function(e){e.Status?0!=e.Data.length&&(t.doctorList=e.Data.map(function(e){var t={Id:e.Id,Name:e.Name,value:e.Name};return t})):t.$msg.warning(e.Message)})},closeDialog:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,this.$refs.content.save();case 3:a=e.sent,console.log(a),a&&(this.getPatientList(),this.$store.commit("public/SET_DIALOGDATA",{})),e.next=9;break;case 8:this.$store.commit("public/SET_DIALOGDATA",{});case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getPatientList:function(){var e=this,t={inHospStartTime:this.timeRange&&this.timeRange[0]||Object(r["a"])(null,new Date((new Date).getTime()-6048e5)),inHospEndTime:this.timeRange&&this.timeRange[1]||Object(r["a"])(),QueryKey:this.patMessage,AreaType:this.selectAreas,PageIndex:this.pageIndex,PageSize:this.pageSize,FirstDoctorIds:this.FirstDoctorIds,IsAsc:!0};this.$Api.getOutHosPats(t).then(function(a){if(1===e.pageIndex){var n={inHospStartTime:e.timeRange&&e.timeRange[0]||Object(r["a"])(null,new Date((new Date).getTime()-6048e5)),inHospEndTime:e.timeRange&&e.timeRange[1]||Object(r["a"])(),QueryKey:e.patMessage,AreaType:e.selectAreas,PageIndex:e.pageIndex,PageSize:e.pageSize,FirstDoctorIds:e.FirstDoctorIds,IsAsc:!0};if(JSON.stringify(n)!==JSON.stringify(t))return}var i=a.Data||[];e.totalPage=a.Count,e.$store.commit("public/SET_PATIENTTABLELIST",i)})},search:function(){this.pageIndex=1,this.debouceElg()},handleCurrentChange:function(e){console.log(e,"当前页码"),this.pageIndex=e,this.getPatientList()},handleSizeChange:function(e){this.pageSize=e,this.pageIndex=1,this.getPatientList()},handleSelArea:function(e){console.log(e,"区域筛选"),e.length>=2&&-1!=e.indexOf(0)&&(0==e[0]?(e.shift(),this.selectAreas=e):this.selectAreas=[0]),this.search()},getTableConfig:function(){var e=this,t={tableCode:"OutDepartmentPatient"};this.$Api.getTableColConfig(t).then(function(t){t.Status&&(e.columnsAll=t.Data,e.columns=[],t.Data.forEach(function(t){t.Ifcover&&e.columns.push(t)}),e.columns.length==e.columnsAll.length?e.checkAll=!0:e.checkAll=!1)})},handleCheckAllChange:function(e){e?this.columnsAll.forEach(function(e){e.Ifcover=!0}):this.columnsAll.forEach(function(e){e.Ifcover=!1})},saveConfig:function(){var e=this,t={tableCode:"OutDepartmentPatient"};this.columnSet=!1;var a=[];this.columnsAll.forEach(function(e){e.Ifcover&&a.push(e.Code)}),t["ColumnCode"]=a,this.$Api.setTableColConfig(t,a).then(function(t){t.Status&&(e.getTableConfig(),e.$msg.success("操作成功"))})},exportData:function(){var e=this;if(!this.showLoading){var t="",a=[];-1!=this.selectAreas.indexOf(0)?this.options.forEach(function(e){0!=e.value&&a.push(e.value)}):a=this.selectAreas;var n={inHospStartTime:this.timeRange&&this.timeRange[0]||Object(r["a"])(null,new Date((new Date).getTime()-6048e5)),inHospEndTime:this.timeRange&&this.timeRange[1]||Object(r["a"])(),QueryKey:this.patMessage,AreaType:a,PageIndex:this.pageIndex,PageSize:this.pageSize,IsAsc:!0,UserId:this.user.UserInfo.Id,HospitalAreaId:this.user.HospitalAreaId},i=JSON.stringify(n),s={Prognosis:"转归",TriageLevel:"级别",PatientName:"姓名",PatGenderCode:"性别",AgeYear:"年龄"},o={};this.columnsAll.forEach(function(e){e.Ifcover&&(o[e.Code]=e.Name)});var c=JSON.stringify(Object.assign({},s,o));t="".concat(URLCONFIG.Doctor,"/api/v1/Patient/OutHospitalPatientExport?dto=").concat(i,"&columns=").concat(c,"&FirstDoctorIds=").concat(JSON.stringify(this.FirstDoctorIds)),console.log(t),this.showLoading=!0,this.$confirm("数据导出中，您可以操作其他内容，但请勿退出系统！","提示",{confirmButtonText:"确定",showCancelButton:!1}),Object(r["h"])(t,"出科患者",function(){e.$msg.success("数据导出成功！"),e.showLoading=!1})}},callbackPatient:function(e){var t={title:"患者召回",visible:!0,data:e};this.$store.commit("public/SET_DIALOGDATA",t)},gotoDetail:function(e){this.$router.push({name:"medicalHistory",query:{id:e.Id,from:"caseControl"}})}},computed:Object(s["a"])({},Object(u["b"])({user:"public/GET_USER",patList:"public/GET_PATIENTTABLELIST",dialogData:"public/GET_DIALOGDATA"}),{options:function(){var e=[{name:"全部",value:0}];return this.user.DiagnosisAreas.forEach(function(t){var a={};a.name=t.DiagnosisAreaName,a.value=t.DiagnosisAreaType,e.push(a)}),e}}),watch:{patMessage:function(e){this.search()}}},d=p,m=(a("5abb"),a("2877")),f=Object(m["a"])(d,n,i,!1,null,null,null);t["default"]=f.exports},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},f6ff:function(e,t,a){}}]);
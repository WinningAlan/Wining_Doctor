(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-764708f9"],{"04d9":function(e,t,a){},"33d5":function(e,t,a){"use strict";var o=a("04d9"),i=a.n(o);i.a},3768:function(e,t,a){},"3aff":function(e,t,a){},"3ceb":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inspectDoctorAdvice doctor-advice"},[a("doctorAdviceTable",{attrs:{columns:e.columns,tableData:e.tableData,orderType:7,callback:e.callback},scopedSlots:e._u([{key:"adviceName",fn:function(t){var a=t.scope;return[a.row._edit?e._t("change",null,{index:a.row._index,itemName:a.row.DictItemName,departmentCode:e.departmentCode,categoryNo:e.categoryNo}):[e._v(e._s(a.row.DictItemName))]]}},{key:"InsuranceUseFlag",fn:function(t){var o=t.scope;return[a("el-checkbox",{model:{value:o.row.InsuranceUseFlag,callback:function(t){e.$set(o.row,"InsuranceUseFlag",t)},expression:"scope.row.InsuranceUseFlag"}})]}}])}),e._t("search",null,{departmentCode:e.departmentCode,categoryNo:e.categoryNo}),a("h2",[e._v("共性编辑")]),a("el-form",{ref:"inspectDoctorAdvice",staticClass:"doctor-advice-form",attrs:{model:e.commonData,rules:e.isVerification?e.rules:e.rulesNull,"label-position":"right","label-width":"80px"}},[a("el-form-item",{staticClass:"all attention",attrs:{label:"临床摘要",prop:"Attention"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",autosize:"",resize:"none",maxlength:"500"},model:{value:e.commonData.Attention,callback:function(t){e.$set(e.commonData,"Attention",t)},expression:"commonData.Attention"}}),a("div",{staticClass:"textarea-num"},[a("span",{class:{red:e.wordLength>500}},[e._v(e._s(e.wordLength))]),a("span",[e._v("/500")])])],1),a("el-form-item",{staticClass:"all",attrs:{label:"诊断",prop:"Diagnosis"}},[a("el-select",{attrs:{placeholder:"请选择",multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Diagnosis,callback:function(t){e.$set(e.commonData,"Diagnosis",t)},expression:"commonData.Diagnosis"}},e._l(e.diagnoseList,function(e){return a("el-option",{key:e.Id,attrs:{label:e.DiagnosisName,value:e.DiagnosisName}})}),1)],1),a("el-form-item",{attrs:{label:"检查目的",prop:"Target"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},model:{value:e.commonData.Target,callback:function(t){e.$set(e.commonData,"Target",t)},expression:"commonData.Target"}},e._l(e.purposeOptions,function(e){return a("el-option",{key:e.Value,attrs:{label:e.Text,value:e.Text}})}),1)],1),a("el-form-item",{attrs:{label:"媒介项目",prop:"Medium"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},model:{value:e.commonData.Medium,callback:function(t){e.$set(e.commonData,"Medium",t)},expression:"commonData.Medium"}},e._l(e.mediaProjectsOptions,function(e){return a("el-option",{key:e.Value,attrs:{label:e.Text,value:e.Text}})}),1)],1),a("el-form-item",{attrs:{label:"造影剂",prop:"ContrastAgent"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},model:{value:e.commonData.ContrastAgent,callback:function(t){e.$set(e.commonData,"ContrastAgent",t)},expression:"commonData.ContrastAgent"}},e._l(e.contrastMediumOptions,function(e){return a("el-option",{key:e.Value,attrs:{label:e.Text,value:e.Text}})}),1)],1),a("el-form-item",{attrs:{label:"检查科室",prop:"ExcuteDepartment"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},on:{change:e.selectRequestId},model:{value:e.commonData.ExcuteDepartment,callback:function(t){e.$set(e.commonData,"ExcuteDepartment",t)},expression:"commonData.ExcuteDepartment"}},e._l(e.deparmentOps,function(e){return a("el-option",{key:e.Code,attrs:{label:e.Name,value:e.Code}})}),1)],1),a("el-form-item",{attrs:{label:"申请时间",prop:"ApplyTime"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00:00"},on:{change:e.changeTime},model:{value:e.commonData.ApplyTime,callback:function(t){e.$set(e.commonData,"ApplyTime",t)},expression:"commonData.ApplyTime"}})],1),1==e.isMalignantFlag?a("el-form-item",{attrs:{label:"恶性肿瘤",prop:"MalignantFlag"}},[a("el-radio-group",{model:{value:e.commonData.MalignantFlag,callback:function(t){e.$set(e.commonData,"MalignantFlag",t)},expression:"commonData.MalignantFlag "}},[a("el-radio",{attrs:{label:"1"}},[e._v("是")]),a("el-radio",{attrs:{label:"0"}},[e._v("否")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"其他"}},[a("el-checkbox",{model:{value:e.commonData.IsEmergency,callback:function(t){e.$set(e.commonData,"IsEmergency",t)},expression:"commonData.IsEmergency "}},[e._v("加急")]),a("el-checkbox",{model:{value:e.commonData.IsBed,callback:function(t){e.$set(e.commonData,"IsBed",t)},expression:"commonData.IsBed "}},[e._v("床旁")])],1),a("el-form-item",{staticClass:"all",attrs:{label:"备注",prop:"Remark"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Remark,callback:function(t){e.$set(e.commonData,"Remark",t)},expression:"commonData.Remark"}},e._l(e.remarkOptions,function(e){return a("el-option",{key:e.Value,attrs:{label:e.Text,value:e.Text}})}),1)],1)],1),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=(a("7f7f"),a("28a5"),a("6762"),a("2fdb"),a("ac6a"),a("be94")),r=a("2e7f"),s=a("14c8"),c=a("c9b7"),l=a("2f62"),m=a("0713"),u={name:"inspectDoctorAdvice",components:{doctorAdviceTable:s["a"],searchDiagnose:m["a"]},props:{tableData:{type:Array,required:!0},commonObj:{type:Object,required:!0},isChange:{type:Boolean,default:!1},isVerification:{type:Boolean,default:!0},callback:{type:Function,default:function(){}},generalEditor:{type:Array,default:function(){return[]}}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},columns:r["h"],rules:{Attention:[{required:!0,message:"请输入临床摘要",trigger:"change"}],Diagnosis:[{required:!0,message:"请选择诊断",trigger:"change"}],Target:[{required:!0,message:"请选择检查目的",trigger:"change"}],ExcuteDepartment:[{required:!0,message:"请选择检查科室",trigger:"change"}]},rulesNull:{},commonData:{DiagnosisAreaType:"",OrderType:7,IsAdditional:!1,EffectiveTime:1,Attention:"",Diagnosis:[],DiagnosisCode:[],Target:"明确诊断",Medium:"",ContrastAgent:"",ExcuteDepartment:"",IsEmergency:!1,IsBed:!1,Remark:"",ApplyTime:"",depStr:"",MalignantFlag:0},diagnoseList:[],departmentParentList:[]}},created:function(){var e=this;this.commonData.Diagnosis=[],this.getOldSubmit(),this.commonData.DiagnosisAreaType=this.selectArea.DiagnosisAreaType,this.nowTime=this.commonData.ApplyTime=this.commonData.ApplyTime?this.commonData.ApplyTime:Object(c["a"])(),this.isVerification&&this.getAttention(),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")}},computed:Object(n["a"])({},Object(l["b"])({departmentOptions:"public/GET_ALLDEP",patientMsg:"public/GET_PATIENTMSG",selectArea:"home/GET_SELECTAREA",isMalignantFlag:"configuration/GET_ISMALIGNANTFLAG"}),{mediaProjectsOptions:function(e){return this.$store.getters["public/getDic"]("Vector").filter(function(e){return-1!==e.Value})},contrastMediumOptions:function(e){return this.$store.getters["public/getDic"]("ContrastAgent").filter(function(e){return-1!==e.Value})},wordLength:function(){return this.commonData.Attention.length},purposeOptions:function(e){return this.$store.getters["public/getDic"]("PurposeOfTest").filter(function(e){return-1!==e.Value})},remarkOptions:function(e){return this.$store.getters["public/getDic"]("CheckRemark").filter(function(e){return-1!==e.Value})},departmentCode:function(){var e=this.tableData.filter(function(e){return!e.IsDeleted});return e.length?this.commonData.ExcuteDepartment:""},categoryNo:function(){return this.tableData[0]?this.tableData[0].ParentCategoryCode:""},deparmentOps:function(){var e=this,t=Object(c["r"])(this.tableData,"NewDepartmentList");this.$route.query.id&&this.patientMsg.RegistId&&this.patientMsg.RegisterInfoList.forEach(function(a){e.patientMsg.RegistId===a.HisRegistId&&!t.includes(a.RegDepartmentCode)&&t.push(a.RegDepartmentCode)}),t.length&&(this.commonData.ExcuteDepartment=this.commonData.ExcuteDepartment?this.commonData.ExcuteDepartment:t[0]);var a=[];return this.$emit("changrequestId",this.commonData.ExcuteDepartment),t.forEach(function(t){e.departmentOptions.forEach(function(e){e.Code==t&&a.push(e)})}),a}}),watch:{commonObj:{handler:function(e,t){for(var a in e)this.commonData[a]=e[a]},immediate:!0,deep:!0},patientMsg:{handler:function(e){this.isVerification&&!this.isChange&&e.Diagnosis&&(this.commonData.Diagnosis=e.Diagnosis.slice(0,e.Diagnosis.length-1).split(";"),this.commonData.DiagnosisCode=e.DiagnosisCode.slice(0,e.DiagnosisCode.length-1).split(";"),this.getOldSubmit())},immediate:!0,deep:!0}},methods:{getAttention:function(){var e=this;this.$Api.getAttention({itemName:"临床摘要",inHospPatId:this.$route.query.id}).then(function(t){var a=t.Data||[],o="",i="",n="";a.forEach(function(e){if("主诉:"===e.title||"主诉："===e.title)o+="".concat(e.name,"、");else if("现病史:"===e.title||"现病史："===e.title)i+="".concat(e.name,"、");else if("体格检查:"===e.title||"体格检查："===e.title){var t=e.sjyname.split("（");t[0]+="：".concat(e.name),n+=t.join("（")+"、"}}),o=o.substring(0,o.length-1),i=i.substring(0,i.length-1),n=n.substring(0,n.length-1);var r="".concat(o).concat(o&&"\n").concat(i).concat(i&&"\n").concat(n).concat(n&&"\n");r=r.substring(0,r.length-1),e.commonData.Attention=e.commonData.Attention||r})},changeTime:function(e){+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("医嘱开始时间不允许早于患者入科时间！"),this.commonData.ApplyTime=Object(c["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime))),this.commonData.IsAdditional=parseInt(+new Date(e)/6e4)<parseInt(+new Date(this.nowTime)/6e4)},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.inspectDoctorAdvice.validate(function(a,o){if(console.log(o),a){if(!e.tableData.filter(function(e){return!e.IsDeleted}).length)return e.$msg.info("当前没有医嘱项目，请添加后再保存！"),t(!1);if(e.wordLength>500)return setTimeout(function(){e.$msg.info("临床摘要内容超出长度限制，请修改！")},0),t(!1);var i=Object(n["a"])({},e.commonData),r=[];i.Diagnosis.forEach(function(t){e.diagnoseList.forEach(function(e,a){t===e.DiagnosisName&&(r[a]=e)})}),i.Diagnosis="",i.DiagnosisCode="",r.forEach(function(e){e&&(i.Diagnosis+=e.DiagnosisName+";",i.DiagnosisCode+=e.DiagnosisCode+";")}),i.InHouseId=e.$route.query.id,t({Details:i,Items:e.tableData})}else t(!1),console.log("error submit!!")})})},selectRequestId:function(e){this.requestId=e,this.$emit("changrequestId",e)},getOldSubmit:function(){var e=this;this.$route.query.id&&this.$Api.getHistoryDiagnoseList({inHouseId:this.$route.query.id}).then(function(t){e.diagnoseList=t.Data||[],e.isVerification&&(!e.commonData.Diagnosis||e.commonData.Diagnosis&&0===e.commonData.Diagnosis.length)&&e.diagnoseList.length&&(e.commonData.Diagnosis=e.diagnoseList.map(function(e){return e.DiagnosisName}),e.commonData.DiagnosisCode=e.diagnoseList.map(function(e){return e.DiagnosisCode}))})}}},d=u,p=(a("8db6"),a("2877")),f=Object(p["a"])(d,o,i,!1,null,null,null);t["a"]=f.exports},"4ed1":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"drugDoctorAdvice doctor-advice"},[a("doctorAdviceTable",{attrs:{orderType:14,columns:e.columns,tableData:e.tableData,"row-key":"HisMedId","row-class-name":e.rowClass},on:{"row-contextmenu":e.contextmenu},scopedSlots:e._u([{key:"adviceName",fn:function(t){var o=t.scope;return[o.row._edit?e._t("change",null,{index:o.row._index,itemName:o.row.MedicineName}):[o.row.Insurance?a("span",[e._v("["+e._s(o.row.Insurance)+"]")]):e._e(),"普通"!==o.row.SpecialName?a("span",[e._v("["+e._s(o.row.SpecialName)+"]")]):e._e(),e._v("\n        "+e._s(o.row.MedicineName+" "+o.row.SpecificationName)+"\n      ")]]}},{key:"specimen",fn:function(t){var o=t.scope;return[a("el-input-number",{attrs:{placeholder:"剂量",min:0,step:o.row.step[o.row.Unit],"controls-position":"right"},on:{change:function(t){e.computeNum(o.row)}},model:{value:o.row.Dose,callback:function(t){e.$set(o.row,"Dose",t)},expression:"scope.row.Dose"}}),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.computeNum(o.row,"unit")}},model:{value:o.row.Unit,callback:function(t){e.$set(o.row,"Unit",t)},expression:"scope.row.Unit"}},e._l(o.row.doseOption,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)]}},{key:"remarks",fn:function(t){var o=t.scope;return[3===e.commonData.DiagnosisAreaType||e.commonData.IsOutHospitalMedicine?a("el-input-number",{staticClass:"dosage",attrs:{placeholder:"数量",min:1,precision:0,"controls-position":"right"},on:{change:function(t){e.changeDosage(o.row,t)}},model:{value:o.row.Dosage,callback:function(t){e.$set(o.row,"Dosage",t)},expression:"scope.row.Dosage"}}):a("span",[e._v(e._s(o.row.Dosage))]),e._v("\n\n      "+e._s(o.row.DosageUnit)+"\n    ")]}},{key:"ReimbursementType",fn:function(t){var o=t.scope;return[a("el-checkbox",{attrs:{"true-label":1,"false-label":2,disabled:!o.row.MedicalInsuranceControlFlag},model:{value:o.row.ReimbursementType,callback:function(t){e.$set(o.row,"ReimbursementType",t)},expression:"scope.row.ReimbursementType"}})]}},{key:"InsuranceUseFlag",fn:function(t){var o=t.scope;return[a("el-checkbox",{model:{value:o.row.InsuranceUseFlag,callback:function(t){e.$set(o.row,"InsuranceUseFlag",t)},expression:"scope.row.InsuranceUseFlag"}})]}}])}),e._t("search"),a("h2",[e._v("共性编辑")]),a("el-form",{ref:"inspectDoctorAdvice",staticClass:"doctor-advice-form",attrs:{model:e.commonData,rules:e.isVerification?e.rules:e.rulesNull,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始时间",prop:"StartTime"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00:00"},on:{change:e.changeTime},model:{value:e.commonData.StartTime,callback:function(t){e.$set(e.commonData,"StartTime",t)},expression:"commonData.StartTime"}})],1),a("el-form-item",{staticClass:"usage",attrs:{label:"用法",prop:"UsageCode"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","default-first-option":"","filter-method":e.remoteMethod},on:{"visible-change":function(t){e.remoteMethod("",t)}},model:{value:e.commonData.UsageCode,callback:function(t){e.$set(e.commonData,"UsageCode",t)},expression:"commonData.UsageCode"}},e._l(e.usageList,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.Text))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.Value))])])}),1),a("el-input-number",{attrs:{disabled:"静滴"!==e.commonData.UsageText,step:10,"controls-position":"right",min:0},model:{value:e.commonData.DrippingSpeed,callback:function(t){e.$set(e.commonData,"DrippingSpeed",t)},expression:"commonData.DrippingSpeed"}})],1),a("el-form-item",{attrs:{label:"频次",prop:"FrequencyCode"}},[a("el-select",{attrs:{placeholder:"请选择","value-key":"Code","automatic-dropdown":"",filterable:""},on:{change:e.setFrequencyCode},model:{value:e.frequency,callback:function(t){e.frequency=t},expression:"frequency"}},e._l(e.frequencyOptions,function(t){return a("el-option",{key:t.Code,attrs:{label:t.InputString,value:t}},[e._v(e._s(t.InputString))])}),1)],1),a("el-form-item",{staticClass:"excute-time",attrs:{label:"执行时间",prop:"ExcuteTimePeriod"}},["W"===e.frequency.Unit?a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.setExcuteTime},model:{value:e.timeArr[0],callback:function(t){e.$set(e.timeArr,0,t)},expression:"timeArr[0]"}},e._l(e.weekOptions,function(t){return a("el-option",{key:t.Value,attrs:{disabled:t.Value>e.endTime,label:t.Text,value:t.Value}},[e._v(e._s(t.Text))])}),1):a("el-time-select",{attrs:{clearable:!1,disabled:!e.timeArr.length||e.specialUnit.includes(e.frequency.Unit),"picker-options":e.endTime,placeholder:"请选择"},on:{change:e.setExcuteTime},model:{value:e.timeArr[0],callback:function(t){e.$set(e.timeArr,0,t)},expression:"timeArr[0]"}}),a("span",{staticClass:"text"},[e._v(e._s(e.timeText))])],1),a("el-form-item",{staticClass:"first-day",attrs:{label:"首日次数",prop:"FirstDayTimes"}},[a("el-input-number",{attrs:{disabled:e.isDH,"controls-position":"right",min:e.commonData.MinNumber,max:e.commonData.firstMaxNum},on:{change:function(t){e.changeNum(e.tableData,t)}},model:{value:e.commonData.FirstDayTimes,callback:function(t){e.$set(e.commonData,"FirstDayTimes",t)},expression:"commonData.FirstDayTimes"}})],1),a("el-form-item",{staticClass:"order-days",attrs:{label:"天数",prop:"OrderDays"}},[a("el-input-number",{attrs:{disabled:!(3===e.commonData.DiagnosisAreaType||e.commonData.IsOutHospitalMedicine),"controls-position":"right",min:1},on:{change:function(t){e.computeNum(e.tableData,"OrderDays",t)}},model:{value:e.commonData.OrderDays,callback:function(t){e.$set(e.commonData,"OrderDays",t)},expression:"commonData.OrderDays"}})],1),a("el-form-item",{attrs:{label:"药房",prop:"PharmacyNumber"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},model:{value:e.commonData.PharmacyNumber,callback:function(t){e.$set(e.commonData,"PharmacyNumber",t)},expression:"commonData.PharmacyNumber"}},e._l(e.pharmacyOptions,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Value}},[e._v(e._s(t.Text))])}),1)],1),a("el-form-item",{staticClass:"effective",attrs:{label:"长/临",prop:"EffectiveTime"}},[a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:2,disabled:3===e.commonData.DiagnosisAreaType||e.commonData.IsOutHospitalMedicine}},[e._v("长")]),a("el-radio-button",{attrs:{label:1}},[e._v("临")])],1),a("el-checkbox",{on:{change:e.changeIsOut},model:{value:e.commonData.IsOutHospitalMedicine,callback:function(t){e.$set(e.commonData,"IsOutHospitalMedicine",t)},expression:"commonData.IsOutHospitalMedicine"}},[e._v("出院带药")])],1)],1),a("div",{staticClass:"el-form-item el-form-item--small all"},[a("label",{staticClass:"el-form-item__label",staticStyle:{width:"80px"}},[e._v("嘱托")]),a("div",{staticClass:"el-form-item__content",staticStyle:{"margin-left":"80px"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Remark,callback:function(t){e.$set(e.commonData,"Remark",t)},expression:"commonData.Remark"}},e._l(e.remarkOptions,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Text}},[e._v(e._s(t.Text))])}),1)],1)]),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=(a("a481"),a("28a5"),a("6762"),a("2fdb"),a("ac6a"),a("2909")),r=a("be94"),s=a("2e7f"),c=(a("6351"),a("14c8")),l=a("c9b7"),m=a("2f62"),u=["Frequency","OrderUsage","Pharmacy"],d=["frequencyOptions","usageArr","pharmacyOptions"],p={name:"drugDoctorAdvice",components:{doctorAdviceTable:c["a"]},props:{tableData:{type:Array,required:!0},commonObj:{type:Object,required:!0},isChange:{type:Boolean,default:!1},isVerification:{type:Boolean,default:!0},contextmenu:{type:Function,default:function(){}}},created:function(){var e=this;console.log(this.tableData,"药品医嘱药品医嘱",this.commonData.EffectiveTime),this.commonData.DiagnosisAreaType=this.patientMsg.AreaType,this.isVerification||(this.commonData.DiagnosisAreaType=this.selectArea.DiagnosisAreaType||1),this.commonData.OrderDays=3===this.commonData.DiagnosisAreaType?1:void 0,this.getDictData(),this.nowTime=this.commonData.StartTime=this.commonData.StartTime?this.commonData.StartTime:Object(l["a"])(),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(l["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")}},watch:{commonObj:function(e){for(var t in e)console.log(t),this.commonData.hasOwnProperty(t)&&(this.commonData[t]=e[t]);this.computeNum(this.tableData)},"commonData.EffectiveTime":function(e){console.log("commonData.EffectiveTime",e),2==e?this.commonData.MinNumber=0:(this.commonData.MinNumber=this.commonData.OrderDays>1?0:1,this.commonData.FirstDayTimes=this.commonData.FirstDayTimes?this.commonData.FirstDayTimes:1),this.computeNum(this.tableData)},"commonData.UsageCode":function(e){for(var t=0;t<this.usageOptions.length;t++){var a=this.usageOptions[t];a.Value===e&&(this.commonData.UsageText=a.Text,"静滴"!==a.Text&&(this.commonData.DrippingSpeed=void 0))}}},computed:Object(r["a"])({},Object(m["b"])({selectArea:"home/GET_SELECTAREA",patientMsg:"public/GET_PATIENTMSG"}),{remarkOptions:function(e){var t=this.$store.getters["public/getDic"]("Entrust")||[];return t.filter(function(e){return-1!==e.Value})},usageOptions:function(){return console.log(this.tableData,22),this.tableData[0]?this.tableData[0].MedicinalUsageList[0]?this.tableData[0].MedicinalUsageList:this.usageArr:[]},timeText:function(){var e=this;if("W"===this.frequency.Unit){var t=Object(n["a"])(this.timeArr);return t.forEach(function(a,o){t[o]=e.weekOptions[a-1].Text}),t.slice(1).join("/")}return this.timeArr.slice(1).join("/")},endTime:function(){var e=this.frequency.Unit;if(this.timeArr.length>1){var t="H"===e?this.timeArr.length:this.frequency.Count-1;return"W"===e?7-(this.frequency.Count-1)*this.timeLag:{start:"00:00",step:"01:00",end:Object(l["f"])(24-t*this.timeLag)+":00"}}return"W"===e?7:{start:"00:00",step:"01:00",end:"23:59"}}}),data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(l["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},rowClass:function(e){var t=e.row;return t.StockNum>0?"":"disabled"},rules:{StartTime:[{required:!0,message:"请输入开始时间",trigger:"blur"}],UsageCode:[{required:!0,message:"请选择用法",trigger:"change"}],FrequencyCode:[{required:!0,message:"请选择频次",trigger:"change"}],ExcuteTimePeriod:[{required:!0,message:"请选择执行时间",trigger:"change"}],EffectiveTime:[{required:!0,message:"请选择长/临",trigger:"change"}]},rulesNull:{},columns:s["c"],frequency:"",timeArr:[],specialUnit:["1D","2D","3D","ST","T","4D"],timeLag:8,isDH:!1,commonData:{MinNumber:0,OrderType:14,MaxNumber:100,firstMaxNum:100,DiagnosisAreaType:"",IsAdditional:!1,InHouseId:"",StartTime:"",EndTime:"",DrippingSpeed:void 0,UsageCode:"",UsageText:"",FrequencyCode:"",FrequencyText:"",ExcuteTimePeriod:"",FirstDayTimes:1,OrderDays:void 0,PharmacyNumber:"",EffectiveTime:1,IsOutHospitalMedicine:!1,Remark:""},usageArr:[],pharmacyOptions:[],weekOptions:[{Text:"周一",Value:1},{Text:"周二",Value:2},{Text:"周三",Value:3},{Text:"周四",Value:4},{Text:"周五",Value:5},{Text:"周六",Value:6},{Text:"周日",Value:7}],statusOptions:[{Text:"长期",Value:2},{Text:"临时",Value:1}],frequencyOptions:[],speedOptions:[],selectEl:{},usageList:[]}},methods:{changeDosage:function(e,t){console.log(e,t,"changeDosage"),e.FirstDayDosageNum=t},computeNum:function(e,t,a){var o=this;"unit"===t&&(e.Dose=e.Unit===e.SpecificationUnit?e.Dose*e.SpecificationFactor:parseInt(e.Dose/e.SpecificationFactor),console.log(e.Unit)),console.log(e,this.commonData,"commonData"),"OrderDays"===t&&(2==this.commonData.EffectiveTime?this.commonData.MinNumber=0:(this.commonData.FirstDayTimes||(this.commonData.FirstDayTimes=a>1?this.commonData.FirstDayTimes:1),this.commonData.MinNumber=a>1?0:1));var i=this.commonData.OrderDays||1,n=this.commonData.FrequencyCode?this.commonData.MaxNumber:1,r="object"===Object(l["t"])(e)?[e]:e;r.forEach(function(t){var a=t.Dose*n*i;3===o.commonData.DiagnosisAreaType&&i<=1&&(o.commonData.FirstDayTimes=o.commonData.FirstDayTimes||1);var r,s,c,l,m=t.Dose*o.commonData.FirstDayTimes*(2===o.commonData.EffectiveTime?1:i);t.DosageUnitCategory=t.DosageUnit===t.InhospitalUnit?1:2,console.log(m,a,t.Dose,"firstNum",o.commonData.FirstDayTimes),t.Unit===t.SpecificationUnit?(r=Math.ceil((a/t.SpecificationFactor).toFixed(4)),s=Math.ceil((m/t.SpecificationFactor).toFixed(4))):(r=Math.ceil(a.toFixed(4)),s=Math.ceil(m.toFixed(4))),2===t.DosageUnitCategory?(c=Math.ceil(r/t.OutPatientFactor),l=Math.ceil(s/t.OutPatientFactor)):(c=Math.ceil(r/t.InhospitalFactor),l=Math.ceil(s/t.InhospitalFactor)),3===o.commonData.DiagnosisAreaType||o.commonData.IsOutHospitalMedicine?(t.Dosage=c,t.FirstDayDosageNum=c,console.log(111)):(t.Dosage=2===o.commonData.EffectiveTime?c:l,t.FirstDayDosageNum=l),console.log(e,o.commonData.DiagnosisAreaType,c,a,r,"12",l,o.commonData.EffectiveTime)})},changeTime:function(e){if(+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("医嘱开始时间不允许早于患者入科时间！"),this.commonData.StartTime=Object(l["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime))),this.commonData.IsAdditional=parseInt(+new Date(e)/6e4)<parseInt(+new Date(this.nowTime)/6e4),this.specialUnit.includes(this.frequency.Unit)){var t=this.frequency.DataTime,a=Object(l["a"])("yyyy/MM/dd HH:mm",new Date(this.commonData.StartTime)).split(" ")[1];a=t&&t.indexOf(":")>-1?t:a,this.commonData.ExcuteTimePeriod=a,this.timeArr=[a]}this.figureUp()},setExcuteTime:function(e){var t=this;console.log(this.timeArr,"setExcuteTime");var a=this.frequency.Unit;if(this.timeArr.length<2&&"H"!==a)this.commonData.ExcuteTimePeriod=e+"";else if(this.timeArr.length>1)if("D"===a)this.timeArr=this.timeArr.map(function(a,o){var i=Object(l["f"])(parseInt(e)+t.timeLag*o);return 24==i?"23:59":i+":00"}),this.commonData.ExcuteTimePeriod=this.timeArr.join(",");else if("W"===a){this.timeArr=this.timeArr.map(function(a,o){return e+t.timeLag*o});var o=Object(n["a"])(this.timeArr);o.forEach(function(e,t){o[t]+=";08:00"}),console.log(o),this.commonData.ExcuteTimePeriod=o.join(",")}this.figureUp(),this.computeNum(this.tableData)},setFrequencyCode:function(e,t,a){var o=this;t=t||e.DateTime,this.selectEl=e,this.commonData.FrequencyCode=e.Code,this.commonData.FrequencyText=e.InputString,this.commonData.ExcuteTimePeriod=t;var i=0;if("H"===e.Unit){this.timeArr=[];i=24*e.Count/e.Number,this.timeLag=e.Number;for(var n=this.selectTimeArr(24*e.Count/e.Number),r=0;r<n.length;r++)this.timeArr.push(n[r].slice(11))}else if("D"===e.Unit)this.timeArr=t.split(","),i=e.Count*e.Number,this.timeArr.length>1&&(this.timeLag=parseInt(this.timeArr[1])-parseInt(this.timeArr[0]));else if("W"===e.Unit){i=1,this.timeArr=[];var s=t.split(",");s.forEach(function(e){o.timeArr.push(+e.split(";")[0])}),this.timeArr.length>1&&(this.timeLag=this.timeArr[1]-this.timeArr[0]),this.commonData.firstMaxNum=this.commonData.FirstDayTimes=1,this.isDH=!0}else{this.commonData.firstMaxNum=this.commonData.FirstDayTimes=1,this.isDH=!0,i=1;var c=Object(l["a"])("yyyy/MM/dd HH:mm",new Date(this.commonData.StartTime)).split(" ")[1];c=t&&t.indexOf(":")>-1?t:c,this.commonData.ExcuteTimePeriod=c,this.timeArr=[c]}"ST"!==e.InputString&&"once"!==e.InputString||(this.commonData.EffectiveTime=a?this.commonData.EffectiveTime:1),this.commonData.MaxNumber=i,this.figureUp(a),a||this.computeNum(this.tableData)},getDictData:function(){var e=this;console.log(1111111111,this.isChange),u.forEach(function(t,a){"Frequency"===t?e.$Api.getFrequency().then(function(t){if(e.frequencyOptions=t.Data||[],e.isChange){for(var a in console.log(e.commonObj,"this.commonObj"),e.commonObj)e.commonData[a]=e.commonObj[a];e.commonData.OrderDays=e.commonData.OrderDays?e.commonData.OrderDays:void 0,e.commonData.DrippingSpeed=e.commonData.DrippingSpeed?e.commonData.DrippingSpeed:void 0,e.frequency=e.frequencyOptions.filter(function(t){return t.Code===e.commonObj.FrequencyCode})[0],e.setFrequencyCode(e.frequency,e.commonObj.ExcuteTimePeriod,e.isChange)}else e.commonData.UsageText=e.tableData[0].UsageText,e.commonData.UsageCode=e.tableData[0].UsageCode,e.commonData.PharmacyNumber=e.tableData[0].PharmacyCode,e.frequency=e.tableData[0].frequency,e.setFrequencyCode(e.frequency)}):e.$Api.getDictData({dictType:t}).then(function(t){e[d[a]]=t.Data||[],"usageArr"===d[a]&&(e.usageList=e.usageArr)})})},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.inspectDoctorAdvice.validate(function(a,o){if(console.log(o),a){e.tableData.length||(e.$msg.info("当前没有医嘱项目，请添加后再保存！"),t(!1));var i=Object(r["a"])({},e.commonData);if(3===e.commonData.DiagnosisAreaType){var n=new Date(i.StartTime),s=new Date(+n+864e5*(i.OrderDays?i.OrderDays:1));i.EndTime=Object(l["a"])("yyyy-MM-dd HH:mm",s)}else i.EndTime="";i.OrderDays=void 0===i.OrderDays?0:i.OrderDays,i.InHouseId=e.$route.query.id,t({doctorOrderMain:i,doctorOrderDetails:e.tableData})}else t(!1),console.log("error submit!!")})})},format:function(e){var t=new Date(e),a=new Date(this.commonData.StartTime),o=a.getFullYear(),i=a.getMonth()+1,n=a.getDate(),r=t.getHours(),s=t.getMinutes();return Object(l["f"])(o)+"-"+Object(l["f"])(i)+"-"+Object(l["f"])(n)+" "+Object(l["f"])(r)+":"+Object(l["f"])(s)},selectTimeArr:function(e){var t=[],a=864e5,o=a/e,i=new Date;i.setHours(0,0,0,0);for(var n=i.getTime(),r=0;r<e;r++)t.push(this.format(n+r*o));return t},figureUp:function(e){var t=this;console.log(e,"figureUp",this.commonData.FirstDayTimes);var a=this.selectEl,o=0;if("D"===a.Unit||"H"===a.Unit){var i=Object(n["a"])(this.timeArr),r=0,s=new Date(this.commonData.StartTime),c=s.getFullYear(),m=s.getMonth()+1,u=s.getDate();i.forEach(function(e){e=Object(l["f"])(c)+"-"+Object(l["f"])(m)+"-"+Object(l["f"])(u)+" "+e,new Date(t.commonData.StartTime).getTime()<=new Date(e).getTime()&&r++}),o=i.length,r>=o?(this.commonData.firstMaxNum=r,e||(this.commonData.FirstDayTimes=r)):(this.commonData.firstMaxNum=r+1,e||(this.commonData.FirstDayTimes=r)),2==this.commonData.EffectiveTime?(e||(this.commonData.FirstDayTimes=this.commonData.FirstDayTimes?this.commonData.FirstDayTimes:1),this.commonData.MinNumber=0):(this.commonData.MinNumber=1,e||(this.commonData.FirstDayTimes=r||1)),this.isDH=!1}else this.commonData.firstMaxNum=1,this.souNum=1,e||(this.commonData.FirstDayTimes=1),this.isDH=!0,console.log(this.commonData.FirstDayTimes,"this.commonData.FirstDayTimes")},changeNum:function(e,t,a){var o=this;console.log("object",e,t,a),void 0===t?this.$nextTick(function(){o.commonData.FirstDayTimes=o.commonData.MinNumber,o.computeNum(e)}):this.computeNum(e)},changeIsOut:function(e){e?(this.commonData.EffectiveTime=1,this.commonData.OrderDays=this.commonData.OrderDays||1,3!==this.commonData.DiagnosisAreaType&&this.computeNum(this.tableData,"OrderDays",this.commonData.OrderDays)):3!==this.commonData.DiagnosisAreaType&&(this.commonData.OrderDays=void 0,this.computeNum(this.tableData,"OrderDays",0))},remoteMethod:function(e,t){e=e&&e.replace(/(^\s*)|(\s*$)/g,""),console.log(e,"val",t),this.usageList=e||!1===t?this.usageOptions.filter(function(t){var a=t.InputCode&&t.InputCode.toLowerCase().indexOf(e.toLowerCase())>-1;return a||t.Text.indexOf(e.toLowerCase())>-1||t.Value.indexOf(e.toLowerCase())>-1}):this.usageOptions}}},f=p,D=(a("df52"),a("2877")),h=Object(D["a"])(f,o,i,!1,null,"9b0f9556",null);t["a"]=h.exports},"53f1":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"ruleForm",staticClass:"doctor-advice-form demo-ruleForm",class:{borderStyle:e.isBorder},attrs:{model:e.ruleForm,rules:e.rules,"label-width":"130px"}},[a("el-form-item",{staticClass:"all",attrs:{label:"会诊类别",prop:"TypeCode"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},on:{change:e.selectConType},model:{value:e.ruleForm.TypeCode,callback:function(t){e.$set(e.ruleForm,"TypeCode",t)},expression:"ruleForm.TypeCode"}},e._l(e.typeData,function(e){return a("el-option",{key:e.key,attrs:{label:e.Value,value:e.Key}})}),1)],1),a("el-form-item",{staticClass:"all",attrs:{label:"会诊项目",prop:"DictItemCode"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},on:{change:e.selectConFee},model:{value:e.ruleForm.DictItemCode,callback:function(t){e.$set(e.ruleForm,"DictItemCode",t)},expression:"ruleForm.DictItemCode"}},e._l(e.itemFeeList,function(t){return a("el-option",{key:t.Id,attrs:{label:t.ItemName,value:t.ItemCode}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.ItemName))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s((+t.Price).toFixed(2))+"/"+e._s(t.Unit))])])}),1)],1),3==e.ruleForm.TypeCode?a("el-form-item",{staticClass:"all",attrs:{label:"拟邀会诊医疗机构",prop:"HospitalCode"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},model:{value:e.ruleForm.HospitalCode,callback:function(t){e.$set(e.ruleForm,"HospitalCode",t)},expression:"ruleForm.HospitalCode"}},e._l(e.allHospital,function(e){return a("el-option",{key:e.Key,attrs:{label:e.Value,value:e.Key}})}),1)],1):e._e(),a("el-form-item",{staticClass:"all",attrs:{label:"拟邀科室",prop:"ConsultationDetails"}},[a("el-select",{ref:"department",attrs:{multiple:"",placeholder:"请选择",filterable:"",remote:"","remote-method":e.depRemoteMethod},on:{focus:e.depFocus},model:{value:e.ruleForm.ConsultationDetails,callback:function(t){e.$set(e.ruleForm,"ConsultationDetails",t)},expression:"ruleForm.ConsultationDetails"}},e._l(e.allDepartment,function(e){return a("el-option",{key:e.Code,attrs:{label:e.Name,value:e.Code}})}),1)],1),a("el-form-item",{staticClass:"all",attrs:{label:"会诊目的",prop:"Target"}},[a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择"},on:{change:e.selectTarget},model:{value:e.ruleForm.Target,callback:function(t){e.$set(e.ruleForm,"Target",t)},expression:"ruleForm.Target"}},e._l(e.targetData,function(e){return a("el-option",{key:e.Key,attrs:{label:e.Value,value:e.Value}})}),1)],1),a("el-form-item",{attrs:{label:"会诊时间",prop:"StartDate"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00"},on:{change:e.changeTime},model:{value:e.ruleForm.StartDate,callback:function(t){e.$set(e.ruleForm,"StartDate",t)},expression:"ruleForm.StartDate"}})],1),a("el-form-item",{attrs:{label:"会诊地点",prop:"LocationCode"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},model:{value:e.ruleForm.LocationCode,callback:function(t){e.$set(e.ruleForm,"LocationCode",t)},expression:"ruleForm.LocationCode"}},e._l(e.siteData,function(e){return a("el-option",{key:e.Key,attrs:{label:e.Value,value:e.Key}})}),1)],1),a("el-form-item",{attrs:{label:"会诊费用",prop:"Fee"}},[a("p",[e._v(e._s(e.feeNow))])]),a("el-form-item",{attrs:{label:"会诊联系人",prop:"ContactName"}},[a("el-select",{attrs:{"default-first-option":"",filterable:"",remote:"","value-key":"DoctorId",placeholder:"请输入姓名","remote-method":e.remoteMethod},on:{change:e.getDoctor,focus:e.focus},model:{value:e.ruleForm.ContactName,callback:function(t){e.$set(e.ruleForm,"ContactName",t)},expression:"ruleForm.ContactName"}},e._l(e.doctorList,function(e,t){return a("el-option",{key:e.DoctorId,attrs:{label:e.DoctorName,value:e}})}),1)],1),a("el-form-item",{attrs:{label:"联系电话",prop:"ContactPhone"}},[a("el-input",{attrs:{placeholder:"请输入联系电话"},model:{value:e.ruleForm.ContactPhone,callback:function(t){e.$set(e.ruleForm,"ContactPhone",t)},expression:"ruleForm.ContactPhone"}})],1),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=(a("7514"),a("be94")),r=(a("ac6a"),a("ade3")),s=a("2f62"),c=a("c9b7"),l=(a("5d2d"),{data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},ruleForm:{InHouseId:"",TypeCode:"",Target:"",TargetCode:"",StartDate:"",LocationCode:"",HospitalCode:"",Fee:0,ConsultationDetails:[],ContactName:"",ContactPhone:"",ContactId:"",DictItemCode:"",ConsultationId:"00000000-0000-0000-0000-000000000000"},rules:Object(r["a"])({DictItemCode:[{required:!0,message:"请选择会诊项目",trigger:"change"}],TypeCode:[{required:!0,message:"请选择会诊类别",trigger:"change"}],Target:[{required:!0,message:"请选择会诊目的",trigger:"change"}],StartDate:[{required:!0,message:"请选择日期",trigger:"change"}],ConsultationDetails:[{required:!0,message:"请选择拟邀科室",trigger:"change"}],LocationCode:[{required:!0,message:"请选择会诊地点",trigger:"change"}]},"DictItemCode",[{required:!0,message:"请选择会诊项目",trigger:"change"}]),siteData:[],typeData:[],targetData:[],allHospital:[],allDepartment:[],nowTime:"",options:[],doctorList:[],itemFeeList:[]}},created:function(){var e=this;console.log("this.user",this.user),this.isVerification||(this.rules={ConsultationDetails:[{required:!0,message:"请选择拟邀科室",trigger:"change"}]}),this.nowTime=this.ruleForm.StartDate=this.ruleForm.StartDate?this.ruleForm.StartDate:Object(c["a"])("yyyy/MM/dd HH:mm",new Date(+new Date+6e5)),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")},this.getDictionaries(),this.ruleForm.ContactName&&this.ruleForm.ContactId||(this.ruleForm.ContactName=this.user.UserInfo.Name,this.ruleForm.ContactId=this.user.UserInfo.Id),this.ruleForm.ContactPhone||(this.ruleForm.ContactPhone=this.user.UserInfo.Telphone),this.getFeeByTypeCodeList(),this.depRemoteMethod()},methods:{depFocus:function(){this.depRemoteMethod()},depRemoteMethod:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$Api.getConAllDepartment({KeyWords:""==t?null:t}).then(function(t){t.Status&&(e.allDepartment=t.Data||[])})},selectConFee:function(e){var t=this;this.itemFeeList.forEach(function(a){a.ItemCode===e&&(t.ruleForm.TypeCode=a.ConsultationTypeCode)})},getFeeByTypeCodeList:function(e){var t=this;this.$Api.getFeeByTypeCodeList({typeCode:e||null}).then(function(a){a.Status&&(t.itemFeeList=a.Data||[],e&&(t.ruleForm.DictItemCode=t.itemFeeList[0]?t.itemFeeList[0].ItemCode:""),t.isAdvice&&t.ruleForm.DictItemCode&&(console.log("qqqqqqq"),t.selectConFee(t.ruleForm.DictItemCode)))})},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.ruleForm.validate(function(a,o){if(console.log(a),a){var i=Object(n["a"])({},e.ruleForm);i.InHouseId=e.$route.query.id||"00000000-0000-0000-0000-000000000000",t(i)}else t(!1),console.log("error submit!!")})})},resetForm:function(e){this.$refs.ruleForm.resetFields()},getDictionaries:function(){var e=this;this.$Api.getConSite({isJudgeEnable:!0}).then(function(t){t.Status&&(e.siteData=t.Data||[],e.ruleForm.LocationCode=e.ruleForm.LocationCode?e.ruleForm.LocationCode:e.siteData[0].Key)}),this.$Api.getConType({}).then(function(t){t.Status&&(console.log(t,"data"),e.typeData=t.Data||[])}),this.$Api.getConTarget({}).then(function(t){t.Status&&(e.targetData=t.Data||[])}),this.$Api.getConAllHospital().then(function(t){t.Status&&(e.allHospital=t.Data||[])})},changeTime:function(e){+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("开始时间不允许早于患者入科时间！"),this.ruleForm.StartDate=Object(c["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime)))},selectTarget:function(e){var t=this;e&&this.targetData.forEach(function(a){a.Value==e&&(t.ruleForm.TargetCode=a.Key)})},remoteMethod:function(e){console.log(e),this.getDoctorName(e)},getDoctor:function(e){console.log("val",e),e&&(this.ruleForm.ContactName=e.DoctorName,this.ruleForm.ContactId=e.DoctorId),console.log(this.ruleForm)},focus:function(){this.getDoctorName("")},getDoctorName:function(e){var t=this;this.$Api.searchUser({InHouseId:this.$route.query.id,DoctorName:e}).then(function(e){console.log("res",e),e.Status&&(t.doctorList=e.Data||[])})},selectConType:function(e){this.ruleForm.DictItemCode="",this.getFeeByTypeCodeList(e)}},watch:{commonObj:{handler:function(e,t){for(var a in e)this.ruleForm.hasOwnProperty(a)&&(this.ruleForm[a]=e[a])},immediate:!0,deep:!0}},props:{commonObj:{type:Object,default:function(){return{}}},isBorder:{type:Boolean,default:!0},isVerification:{type:Boolean,default:!0},isAdvice:{type:Boolean,default:!1}},computed:Object(n["a"])({},Object(s["b"])({user:"public/GET_USER",patientMsg:"public/GET_PATIENTMSG",selectArea:"home/GET_SELECTAREA"}),{feeNow:function(){var e=this,t=this.itemFeeList.find(function(t){if(t.ItemCode===e.ruleForm.DictItemCode)return t});if(t)return 1==t.BillingMethod?(this.ruleForm.Fee=(this.ruleForm.ConsultationDetails.length*t.Price).toFixed(2),(this.ruleForm.ConsultationDetails.length*t.Price).toFixed(2)):(this.ruleForm.Fee=t.Price.toFixed(2),t.Price.toFixed(2))}})}),m=l,u=(a("a267"),a("2877")),d=Object(u["a"])(m,o,i,!1,null,"4ddff52a",null);t["a"]=d.exports},"64a7":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"treatDoctorAdvice doctor-advice"},[a("doctorAdviceTable",{attrs:{columns:e.columns,tableData:e.tableData,"row-key":"DictItemCode",orderType:0},scopedSlots:e._u([{key:"adviceName",fn:function(t){var a=t.scope;return[a.row._edit?e._t("change",null,{index:a.row._index,itemName:a.row.OrderContent,departmentCode:e.departmentCode}):[e._v(e._s(a.row.OrderContent))]]}},{key:"Frequency",fn:function(t){var o=t.scope;return[a("el-select",{attrs:{placeholder:"请选择"},model:{value:o.row.FrequencyCode,callback:function(t){e.$set(o.row,"FrequencyCode",t)},expression:"scope.row.FrequencyCode"}},e._l(e.frequencyOptions,function(e){return a("el-option",{key:e.Code,attrs:{label:e.InputString,value:e.Code}})}),1)]}},{key:"Unit",fn:function(t){var o=t.scope;return[a("el-input-number",{attrs:{placeholder:"剂量",min:0,"controls-position":"right"},model:{value:o.row.Count,callback:function(t){e.$set(o.row,"Count",t)},expression:"scope.row.Count"}}),e._v("\n      "+e._s(o.row.Unit)+"\n      ")]}}])}),e._t("search",null,{departmentCode:e.departmentCode}),a("h2",[e._v("共性编辑")]),a("el-form",{ref:"inspectDoctorAdvice",staticClass:"doctor-advice-form",attrs:{model:e.commonData,rules:e.isVerification?e.rules:e.rulesNull,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始时间",prop:"StartTime"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00:00"},on:{change:e.changeTime},model:{value:e.commonData.StartTime,callback:function(t){e.$set(e.commonData,"StartTime",t)},expression:"commonData.StartTime"}})],1),a("el-form-item",{staticClass:"effective",attrs:{label:"长/临",prop:"EffectiveTime"}},[a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:2,disabled:3===e.selectArea.DiagnosisAreaType}},[e._v("长")])],1),a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:1}},[e._v("临")])],1)],1),a("el-form-item",{attrs:{label:"执行科室",prop:"ExcuteDepartment"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},model:{value:e.commonData.ExcuteDepartment,callback:function(t){e.$set(e.commonData,"ExcuteDepartment",t)},expression:"commonData.ExcuteDepartment"}},e._l(e.deparmentOps,function(e){return a("el-option",{key:e.Code,attrs:{label:e.Name,value:e.Code}})}),1)],1),a("el-form-item",{attrs:{label:"其他"}},[a("el-checkbox",{model:{value:e.commonData.IsEmergency,callback:function(t){e.$set(e.commonData,"IsEmergency",t)},expression:"commonData.IsEmergency"}},[e._v("加急")]),a("el-checkbox",{model:{value:e.commonData.IsBed,callback:function(t){e.$set(e.commonData,"IsBed",t)},expression:"commonData.IsBed"}},[e._v("床旁")])],1),a("el-form-item",{staticClass:"all",attrs:{label:"备注",prop:"Remark"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Remark,callback:function(t){e.$set(e.commonData,"Remark",t)},expression:"commonData.Remark"}},e._l(e.remarkOptions,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Text}},[e._v(e._s(t.Text))])}),1)],1)],1),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=(a("ac6a"),a("be94")),r=a("2e7f"),s=(a("6351"),a("14c8")),c=a("c9b7"),l=a("2f62"),m={name:"treatDoctorAdvice",components:{doctorAdviceTable:s["a"]},props:{tableData:{type:Array,required:!0},commonObj:{type:Object,required:!0},isChange:{type:Boolean,default:!1},isVerification:{type:Boolean,default:!0}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},rules:{StartTime:[{required:!0,message:"请输入开始时间",trigger:"change"}],ExcuteDepartment:[{required:!0,message:"请选择执行科室",trigger:"change"}],EffectiveTime:[{required:!0,message:"请选择长/临",trigger:"change"}]},rulesNull:{},columns:r["u"],commonData:{DiagnosisAreaType:"",OrderType:0,IsAdditional:!1,EffectiveTime:1,StartTime:Object(c["a"])(),ExcuteDepartment:"急诊科",IsEmergency:!1,IsBed:!1,Remark:"",NewDepartmentList:[]},frequencyOptions:[]}},created:function(){var e=this;this.getDictData(),this.commonData.DiagnosisAreaType=this.selectArea.DiagnosisAreaType,this.nowTime=this.commonData.StartTime=this.commonData.StartTime?this.commonData.StartTime:Object(c["a"])(),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")}},computed:Object(n["a"])({},Object(l["b"])({departmentOptions:"public/GET_ALLDEPARTMENTS",patientMsg:"public/GET_PATIENTMSG",selectArea:"home/GET_SELECTAREA"}),{remarkOptions:function(e){return this.$store.getters["public/getDic"]("CureRemark").filter(function(e){return-1!==e.Value})},departmentCode:function(){var e=this.tableData.filter(function(e){return!e.IsDeleted});return e.length?this.commonData.ExcuteDepartment:""},deparmentOps:function(){var e=this,t=[];return this.commonData.NewDepartmentList.forEach(function(a){e.departmentOptions.forEach(function(e){e.Code==a&&t.push(e)})}),t}}),watch:{commonObj:{handler:function(e,t){for(var a in e)this.commonData[a]=e[a]},immediate:!0,deep:!0}},methods:{changeTime:function(e){+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("医嘱开始时间不允许早于患者入科时间！"),this.commonData.StartTime=Object(c["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime))),this.commonData.IsAdditional=parseInt(+new Date(e)/6e4)<parseInt(+new Date(this.nowTime)/6e4),console.log(+new Date(e),"time",this.patientMsg.InHospTime),console.log(parseInt(+new Date(e)/6e4),parseInt(+new Date(this.nowTime)/6e4))},getDictData:function(){var e=this;this.$Api.getFrequency().then(function(t){e.frequencyOptions=t.Data||[]})},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.inspectDoctorAdvice.validate(function(a,o){if(console.log(o),a){e.tableData.filter(function(e){return!e.IsDeleted}).length||(e.$msg.info("当前没有医嘱项目，请添加后再保存！"),t(!1));var i=Object(n["a"])({},e.commonData);i.OrderType=e.tableData[0].ItemType,i.InHouseId=e.$route.query.id,t({Details:i,Orders:e.tableData})}else t(!1),console.log("error submit!!")})})}}},u=m,d=a("2877"),p=Object(d["a"])(u,o,i,!1,null,null,null);t["a"]=p.exports},"7d9f":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mealsDoctorAdvice doctor-advice"},[a("doctorAdviceTable",{attrs:{columns:e.columns,tableData:e.tableData,"row-key":"DictItemCode",orderType:3},scopedSlots:e._u([{key:"adviceName",fn:function(t){var a=t.scope;return[a.row._edit?e._t("change",null,{index:a.row._index,itemName:a.row.OrderContent,departmentCode:e.departmentCode}):[e._v(e._s(a.row.OrderContent))]]}},{key:"Unit",fn:function(t){var o=t.scope;return[a("el-input-number",{attrs:{placeholder:"剂量",min:0,"controls-position":"right"},model:{value:o.row.Count,callback:function(t){e.$set(o.row,"Count",t)},expression:"scope.row.Count"}}),e._v("\n      "+e._s(o.row.Unit)+"\n      ")]}},{key:"Frequency",fn:function(t){var o=t.scope;return[a("el-select",{attrs:{placeholder:"请选择"},model:{value:o.row.FrequencyCode,callback:function(t){e.$set(o.row,"FrequencyCode",t)},expression:"scope.row.FrequencyCode"}},e._l(e.frequencyOptions,function(e){return a("el-option",{key:e.Code,attrs:{label:e.InputString,value:e.Code}})}),1)]}}])}),e._t("search",null,{departmentCode:e.departmentCode}),a("h2",[e._v("共性编辑")]),a("el-form",{ref:"inspectDoctorAdvice",staticClass:"doctor-advice-form",attrs:{model:e.commonData,rules:e.isVerification?e.rules:e.rulesNull,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始时间",prop:"StartTime"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00:00"},on:{change:e.changeTime},model:{value:e.commonData.StartTime,callback:function(t){e.$set(e.commonData,"StartTime",t)},expression:"commonData.StartTime"}})],1),a("el-form-item",{staticClass:"effective",attrs:{label:"长/临",prop:"EffectiveTime"}},[a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:2,disabled:3===e.selectArea.DiagnosisAreaType}},[e._v("长")])],1),a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:1}},[e._v("临")])],1)],1),a("el-form-item",{attrs:{label:"执行科室",prop:"ExcuteDepartment"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:"","automatic-dropdown":""},model:{value:e.commonData.ExcuteDepartment,callback:function(t){e.$set(e.commonData,"ExcuteDepartment",t)},expression:"commonData.ExcuteDepartment"}},e._l(e.departmentOptions,function(e){return a("el-option",{key:e.Code,attrs:{label:e.Name,value:e.Code}})}),1)],1),a("el-form-item",{staticClass:"all",attrs:{label:"备注",prop:"Remark"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Remark,callback:function(t){e.$set(e.commonData,"Remark",t)},expression:"commonData.Remark"}},e._l(e.remarkOptions,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Text}},[e._v(e._s(t.Text))])}),1)],1)],1),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=a("be94"),r=a("2e7f"),s=a("14c8"),c=a("c9b7"),l=a("2f62"),m={name:"mealsDoctorAdvice",components:{doctorAdviceTable:s["a"]},props:{tableData:{type:Array,required:!0},commonObj:{type:Object,required:!0},isChange:{type:Boolean,default:!1},isVerification:{type:Boolean,default:!0}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},rules:{StartTime:[{required:!0,message:"请输入开始时间",trigger:"change"}],ExcuteDepartment:[{required:!0,message:"请选择执行科室",trigger:"change"}],EffectiveTime:[{required:!0,message:"请选择长/临",trigger:"change"}]},rulesNull:{},columns:r["j"],commonData:{DiagnosisAreaType:"",OrderType:3,IsAdditional:!1,EffectiveTime:2,StartTime:Object(c["a"])(),ExcuteDepartment:"急诊科",Remark:""},frequencyOptions:[]}},created:function(){var e=this;this.getDictData(),this.commonData.DiagnosisAreaType=this.selectArea.DiagnosisAreaType,this.nowTime=this.commonData.StartTime=this.commonData.StartTime?this.commonData.StartTime:Object(c["a"])(),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")},3===this.selectArea.DiagnosisAreaType&&(this.commonData.EffectiveTime=1)},watch:{commonObj:{handler:function(e,t){for(var a in e)this.commonData[a]=e[a]},immediate:!0}},computed:Object(n["a"])({},Object(l["b"])({departmentOptions:"public/GET_ALLDEPARTMENTS",patientMsg:"public/GET_PATIENTMSG",selectArea:"home/GET_SELECTAREA"}),{remarkOptions:function(e){return this.$store.getters["public/getDic"]("FoodRemark").filter(function(e){return-1!==e.Value})},departmentCode:function(){var e=this.tableData.filter(function(e){return!e.IsDeleted});return e.length?this.commonData.ExcuteDepartment:""}}),methods:{changeTime:function(e){+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("医嘱开始时间不允许早于患者入科时间！"),this.commonData.StartTime=Object(c["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime))),this.commonData.IsAdditional=parseInt(+new Date(e)/6e4)<parseInt(+new Date(this.nowTime)/6e4),console.log(+new Date(e),"time",this.patientMsg.InHospTime),console.log(parseInt(+new Date(e)/6e4),parseInt(+new Date(this.nowTime)/6e4))},getDictData:function(){var e=this;this.$Api.getFrequency().then(function(t){e.frequencyOptions=t.Data||[]})},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.inspectDoctorAdvice.validate(function(a,o){if(console.log(o),a){e.tableData.length||(e.$msg.info("当前没有医嘱项目，请添加后再保存！"),t(!1));var i=Object(n["a"])({},e.commonData);i.InHouseId=e.$route.query.id,t({Details:i,Orders:e.tableData})}else t(!1),console.log("error submit!!")})})}}},u=m,d=a("2877"),p=Object(d["a"])(u,o,i,!1,null,null,null);t["a"]=p.exports},"85ff":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wordDoctorAdvice doctor-advice"},[a("doctorAdviceTable",{attrs:{columns:e.columns,tableData:e.tableData,orderType:22,"row-key":"WordsType"},scopedSlots:e._u([{key:"adviceName",fn:function(t){var a=t.scope;return[a.row._edit?e._t("change",null,{index:a.row._index,itemName:a.row.OrderContent}):[e._v(e._s(a.row.OrderContent))]]}},{key:"Frequency",fn:function(t){var o=t.scope;return[a("el-select",{attrs:{placeholder:"请选择"},model:{value:o.row.FrequencyCode,callback:function(t){e.$set(o.row,"FrequencyCode",t)},expression:"scope.row.FrequencyCode"}},e._l(e.frequencyOptions,function(e){return a("el-option",{key:e.Code,attrs:{label:e.InputString,value:e.Code}})}),1)]}}])}),e._t("search"),a("h2",[e._v("共性编辑")]),a("el-form",{ref:"inspectDoctorAdvice",staticClass:"doctor-advice-form",attrs:{model:e.commonData,rules:e.isVerification?e.rules:e.rulesNull,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始时间",prop:"StartTime"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00:00"},on:{change:e.changeTime},model:{value:e.commonData.StartTime,callback:function(t){e.$set(e.commonData,"StartTime",t)},expression:"commonData.StartTime"}})],1),a("el-form-item",{staticClass:"effective",attrs:{label:"长/临",prop:"EffectiveTime"}},[a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:2,disabled:3===e.selectArea.DiagnosisAreaType}},[e._v("长")])],1),a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:1}},[e._v("临")])],1)],1),a("el-form-item",{staticClass:"all",attrs:{label:"备注",prop:"Remark"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Remark,callback:function(t){e.$set(e.commonData,"Remark",t)},expression:"commonData.Remark"}},e._l(e.remarkOptions,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Text}},[e._v(e._s(t.Text))])}),1)],1)],1),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=a("be94"),r=a("2e7f"),s=a("14c8"),c=a("c9b7"),l=a("2f62"),m={name:"wordDoctorAdvice",components:{doctorAdviceTable:s["a"]},props:{tableData:{type:Array,required:!0},commonObj:{type:Object,required:!0},isChange:{type:Boolean,default:!1},isVerification:{type:Boolean,default:!0}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},rules:{StartTime:[{required:!0,message:"请输入开始时间",trigger:"change"}],EffectiveTime:[{required:!0,message:"请选择长/临",trigger:"change"}]},rulesNull:{},columns:r["w"],commonData:{DiagnosisAreaType:"",OrderType:5,IsAdditional:!1,EffectiveTime:2,StartTime:"",Remark:""},frequencyOptions:[]}},watch:{commonObj:{handler:function(e,t){for(var a in e)this.commonData[a]=e[a]},immediate:!0}},created:function(){var e=this;this.getDictData(),this.commonData.DiagnosisAreaType=this.selectArea.DiagnosisAreaType,this.nowTime=this.commonData.StartTime=this.commonData.StartTime?this.commonData.StartTime:Object(c["a"])(),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")},3===this.selectArea.DiagnosisAreaType&&(this.commonData.EffectiveTime=1)},computed:Object(n["a"])({},Object(l["b"])({patientMsg:"public/GET_PATIENTMSG",selectArea:"home/GET_SELECTAREA"}),{remarkOptions:function(e){return this.$store.getters["public/getDic"]("TextRemark").filter(function(e){return-1!==e.Value})}}),methods:{changeTime:function(e){+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("医嘱开始时间不允许早于患者入科时间！"),this.commonData.StartTime=Object(c["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime))),this.commonData.IsAdditional=parseInt(+new Date(e)/6e4)<parseInt(+new Date(this.nowTime)/6e4),console.log(+new Date(e),"time",this.patientMsg.InHospTime),console.log(parseInt(+new Date(e)/6e4),parseInt(+new Date(this.nowTime)/6e4))},getDictData:function(){var e=this;this.$Api.getFrequency().then(function(t){e.frequencyOptions=t.Data||[]})},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.inspectDoctorAdvice.validate(function(a,o){if(console.log(o),a){e.tableData.filter(function(e){return!e.IsDeleted}).length||(e.$msg.info("当前没有医嘱项目，请添加后再保存！"),t(!1)),e.commonData.InHouseId=e.$route.query.id;var i=e.tableData.filter(function(t){for(var a in e.commonData)t[a]=e.commonData[a];return!0});t(i)}else t(!1),console.log("error submit!!")})})}}},u=m,d=a("2877"),p=Object(d["a"])(u,o,i,!1,null,null,null);t["a"]=p.exports},"8db6":function(e,t,a){"use strict";var o=a("3aff"),i=a.n(o);i.a},a267:function(e,t,a){"use strict";var o=a("3768"),i=a.n(o);i.a},a436:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nurseDoctorAdvice doctor-advice"},[a("doctorAdviceTable",{attrs:{columns:e.columns,tableData:e.tableData,"row-key":"DictItemCode",orderType:5},scopedSlots:e._u([{key:"adviceName",fn:function(t){var a=t.scope;return[a.row._edit?e._t("change",null,{index:a.row._index,itemName:a.row.OrderContent,departmentCode:e.departmentCode}):[e._v(e._s(a.row.OrderContent))]]}}])}),e._t("search",null,{departmentCode:e.departmentCode}),a("h2",[e._v("共性编辑")]),a("el-form",{ref:"inspectDoctorAdvice",staticClass:"doctor-advice-form",attrs:{model:e.commonData,rules:e.isVerification?e.rules:e.rulesNull,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始时间",prop:"StartTime"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00:00"},on:{change:e.changeTime},model:{value:e.commonData.StartTime,callback:function(t){e.$set(e.commonData,"StartTime",t)},expression:"commonData.StartTime"}})],1),a("el-form-item",{staticClass:"effective",attrs:{label:"长/临",prop:"EffectiveTime"}},[a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:2,disabled:3===e.selectArea.DiagnosisAreaType}},[e._v("长")])],1),a("el-radio-group",{attrs:{"text-color":"#0071E7",fill:"rgba(0,113,231,0.10)"},model:{value:e.commonData.EffectiveTime,callback:function(t){e.$set(e.commonData,"EffectiveTime",t)},expression:"commonData.EffectiveTime"}},[a("el-radio-button",{attrs:{label:1}},[e._v("临")])],1)],1),a("el-form-item",{attrs:{label:"执行科室",prop:"ExcuteDepartment"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.commonData.ExcuteDepartment,callback:function(t){e.$set(e.commonData,"ExcuteDepartment",t)},expression:"commonData.ExcuteDepartment"}},e._l(e.departmentOptions,function(e){return a("el-option",{key:e.Code,attrs:{label:e.Name,value:e.Code}})}),1)],1),a("el-form-item",{staticClass:"all",attrs:{label:"备注",prop:"Remark"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Remark,callback:function(t){e.$set(e.commonData,"Remark",t)},expression:"commonData.Remark"}},e._l(e.remarkOptions,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Text}},[e._v(e._s(t.Text))])}),1)],1)],1),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=a("be94"),r=a("2e7f"),s=(a("6351"),a("14c8")),c=a("c9b7"),l=a("2f62"),m={name:"nurseDoctorAdvice",components:{doctorAdviceTable:s["a"]},props:{tableData:{type:Array,required:!0},commonObj:{type:Object,required:!0},isChange:{type:Boolean,default:!1},isVerification:{type:Boolean,default:!0}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},rules:{StartTime:[{required:!0,message:"请输入开始时间",trigger:"change"}],ExcuteDepartment:[{required:!0,message:"请选择执行科室",trigger:"change"}],EffectiveTime:[{required:!0,message:"请选择长/临",trigger:"change"}]},rulesNull:{},columns:r["k"],commonData:{DiagnosisAreaType:"",OrderType:5,IsAdditional:!1,EffectiveTime:2,StartTime:Object(c["a"])(),ExcuteDepartment:"",Remark:""}}},created:function(){var e=this;this.getDictData(),this.commonData.DiagnosisAreaType=this.selectArea.DiagnosisAreaType,this.nowTime=this.commonData.StartTime=this.commonData.StartTime?this.commonData.StartTime:Object(c["a"])(),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")},3===this.selectArea.DiagnosisAreaType&&(this.commonData.EffectiveTime=1)},computed:Object(n["a"])({},Object(l["b"])({departmentOptions:"public/GET_ALLDEPARTMENTS",patientMsg:"public/GET_PATIENTMSG",selectArea:"home/GET_SELECTAREA"}),{remarkOptions:function(e){return this.$store.getters["public/getDic"]("NursingRemark").filter(function(e){return-1!==e.Value})},departmentCode:function(){var e=this.tableData.filter(function(e){return!e.IsDeleted});return e.length?this.commonData.ExcuteDepartment:""}}),watch:{commonObj:{handler:function(e,t){for(var a in e)this.commonData[a]=e[a]},immediate:!0}},methods:{changeTime:function(e){+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("医嘱开始时间不允许早于患者入科时间！"),this.commonData.StartTime=Object(c["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime))),this.commonData.IsAdditional=parseInt(+new Date(e)/6e4)<parseInt(+new Date(this.nowTime)/6e4),console.log(+new Date(e),"time",this.patientMsg.InHospTime),console.log(parseInt(+new Date(e)/6e4),parseInt(+new Date(this.nowTime)/6e4))},getDictData:function(){},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.inspectDoctorAdvice.validate(function(a,o){if(console.log(o),a){e.tableData.filter(function(e){return!e.IsDeleted}).length||(e.$msg.info("当前没有医嘱项目，请添加后再保存！"),t(!1));var i=Object(n["a"])({},e.commonData);i.InHouseId=e.$route.query.id,t({Details:i,Orders:e.tableData})}else t(!1),console.log("error submit!!")})})}}},u=m,d=a("2877"),p=Object(d["a"])(u,o,i,!1,null,null,null);t["a"]=p.exports},d99b:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"testDoctorAdvice doctor-advice"},[a("doctorAdviceTable",{attrs:{columns:e.columns,tableData:e.tableData,type:e.isCheckedCharge?"expand":"",orderType:8,"row-style":{cursor:"pointer"},callback:e.callback},scopedSlots:e._u([{key:"adviceName",fn:function(t){var a=t.scope;return[a.row._edit?e._t("change",null,{index:a.row._index,itemName:a.row.DictItemName,departmentCode:e.departmentCode,categoryNo:e.categoryNo}):[e._v(e._s(a.row.DictItemName))]]}},{key:"SampleCode",fn:function(t){var o=t.scope;return[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.changeSample(o.row,t)}},model:{value:o.row.SampleCode,callback:function(t){e.$set(o.row,"SampleCode",t)},expression:"scope.row.SampleCode"}},e._l(o.row.specimenOptions,function(t,o){return a("el-option",{key:t,attrs:{label:t,value:o}},[e._v(e._s(t))])}),1)]}},{key:"Price",fn:function(t){var a=t.scope;return[e._v(e._s(e._f("priceFilter")(a.row.CheckedList,a.row.ChargeItems,a.row.Price)))]}},{key:"InsuranceUseFlag",fn:function(t){var o=t.scope;return[a("el-checkbox",{model:{value:o.row.InsuranceUseFlag,callback:function(t){e.$set(o.row,"InsuranceUseFlag",t)},expression:"scope.row.InsuranceUseFlag"}})]}}])}),e._t("search",null,{departmentCode:e.departmentCode,categoryNo:e.categoryNo}),a("h2",[e._v("共性编辑")]),a("el-form",{ref:"inspectDoctorAdvice",staticClass:"doctor-advice-form",attrs:{model:e.commonData,rules:e.isVerification?e.rules:e.rulesNull,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"检验科室",prop:"ExcuteDepartment"}},[a("el-select",{attrs:{placeholder:"请选择","automatic-dropdown":""},on:{change:e.selectRequestId},model:{value:e.commonData.ExcuteDepartment,callback:function(t){e.$set(e.commonData,"ExcuteDepartment",t)},expression:"commonData.ExcuteDepartment"}},e._l(e.deparmentOps,function(e){return a("el-option",{key:e.Code,attrs:{label:e.Name,value:e.Code}})}),1)],1),a("el-form-item",{attrs:{label:"申请时间",prop:"ApplyTime"}},[a("el-date-picker",{attrs:{clearable:!1,"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","default-time":"12:00:00"},model:{value:e.commonData.ApplyTime,callback:function(t){e.$set(e.commonData,"ApplyTime",t)},expression:"commonData.ApplyTime"}})],1),a("el-form-item",{attrs:{label:"其他"}},[a("el-checkbox",{model:{value:e.commonData.IsEmergency,callback:function(t){e.$set(e.commonData,"IsEmergency",t)},expression:"commonData.IsEmergency"}},[e._v("加急")]),a("el-checkbox",{model:{value:e.commonData.IsOtherTest,callback:function(t){e.$set(e.commonData,"IsOtherTest",t)},expression:"commonData.IsOtherTest"}},[e._v("外院送检")])],1),a("el-form-item",{staticClass:"all",attrs:{label:"备注",prop:"Remark"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","allow-create":"","default-first-option":""},model:{value:e.commonData.Remark,callback:function(t){e.$set(e.commonData,"Remark",t)},expression:"commonData.Remark"}},e._l(e.remarkOptions,function(t){return a("el-option",{key:t.Value,attrs:{label:t.Text,value:t.Text}},[e._v(e._s(t.Text))])}),1)],1)],1),e._t("default",null,{submitForm:e.submitForm})],2)},i=[],n=(a("6762"),a("2fdb"),a("be94")),r=(a("ac6a"),a("c5f6"),a("2e7f")),s=a("14c8"),c=a("c9b7"),l=a("2f62"),m={name:"testDoctorAdvice",components:{doctorAdviceTable:s["a"]},props:{tableData:{type:Array,required:!0,default:function(){return[]}},commonObj:{type:Object,required:!0},isChange:{type:Boolean,default:!1},isVerification:{type:Boolean,default:!0},callback:{type:Function,default:function(){}},editIndex:{type:Number,default:0}},filters:{priceFilter:function(e,t,a){var o=0;return t=t||[],console.log(e,"checkArrs"),e.forEach(function(e){t.forEach(function(t){e===t.ChargeItemCode&&(o+=t.Price*t.Count)})}),t.length||(o=a),(+o).toFixed(2)}},data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date)+" 00:00:00")}},rules:{ApplyTime:[{required:!0,message:"请输入申请时间",trigger:"blur"}],ExcuteDepartment:[{required:!0,message:"请选择科室",trigger:"change"}]},rulesNull:{},columns:r["s"],commonData:{DiagnosisAreaType:"",OrderType:8,IsAdditional:!1,EffectiveTime:1,ExcuteDepartment:"",IsEmergency:"",IsOtherTest:!1,Remark:"",ApplyTime:""},specimenOptions:[],tableLength:0}},created:function(){var e=this;this.getDictData(),this.commonData.DiagnosisAreaType=this.selectArea.DiagnosisAreaType,this.nowTime=this.commonData.ApplyTime=this.commonData.ApplyTime?this.commonData.ApplyTime:Object(c["a"])(),this.pickerOptions.disabledDate=function(t){return t.getTime()<+new Date(Object(c["a"])("yyyy/MM/dd",new Date(e.patientMsg.InHospTime))+" 00:00:00")}},computed:Object(n["a"])({},Object(l["b"])({departmentOptions:"public/GET_ALLDEP",isCheckedCharge:"configuration/GET_ISCHECKEDCHARGE",patientMsg:"public/GET_PATIENTMSG",selectArea:"home/GET_SELECTAREA"}),{remarkOptions:function(e){return this.$store.getters["public/getDic"]("TestRemark").filter(function(e){return-1!==e.Value})},departmentCode:function(){var e=this.tableData.filter(function(e){return!e.IsDeleted});return e.length?this.commonData.ExcuteDepartment:""},categoryNo:function(){return this.tableData[0]?this.tableData[0].ParentCategoryCode:""},deparmentOps:function(){var e=this,t=Object(c["r"])(this.tableData,"NewDepartmentList");console.log(this.tableData,t,"this.tableData",this.patientMsg),this.$route.query.id&&this.patientMsg.RegistId&&this.patientMsg.RegisterInfoList.forEach(function(a){e.patientMsg.RegistId===a.HisRegistId&&!t.includes(a.RegDepartmentCode)&&t.push(a.RegDepartmentCode)}),t.length&&(this.commonData.ExcuteDepartment=this.commonData.ExcuteDepartment?this.commonData.ExcuteDepartment:t[0]);var a=[];return this.$emit("changrequestId",this.commonData.ExcuteDepartment),t.forEach(function(t){e.departmentOptions.forEach(function(e){e.Code==t&&a.push(e)})}),a}}),watch:{commonObj:{handler:function(e,t){for(var a in e)this.commonData[a]=e[a]},immediate:!0,deep:!0},editIndex:{handler:function(e){console.log(e,"tablelllllllll"),this.getSampleSetList()},immediate:!0}},methods:{getSampleSetList:function(e){var t=this,a=[];this.tableData.forEach(function(e,t){a.push({t:Math.random(),Code:e.DictItemCode,CategoryNo:e.ParentCategoryCode})}),this.$Api.getSampleSetList(a).then(function(e){if(e.Status){var a=e.Data||{};t.tableData.forEach(function(e){t.$set(e,"specimenOptions",a[e.DictItemCode]||[])})}})},changeSample:function(e,t){this.specimenOptions.forEach(function(a){a.SampleCode===t&&(e.SampleName=a.Name)})},changeTime:function(e){+new Date(e)<+new Date(this.patientMsg.InHospTime)&&(this.$msg.info("医嘱开始时间不允许早于患者入科时间！"),this.commonData.ApplyTime=Object(c["a"])("yyyy/MM/dd HH:mm",new Date(this.patientMsg.InHospTime))),this.commonData.IsAdditional=parseInt(+new Date(e)/6e4)<parseInt(+new Date(this.nowTime)/6e4),console.log(+new Date(e),"time",this.patientMsg.InHospTime),console.log(parseInt(+new Date(e)/6e4),parseInt(+new Date(this.nowTime)/6e4))},getDictData:function(){var e=this;this.$Api.getTestSampleList({t:(new Date).getTime()}).then(function(t){console.log("wqwwww",t),e.specimenOptions=t.Data||[]})},submitForm:function(){var e=this;return new Promise(function(t,a){e.$refs.inspectDoctorAdvice.validate(function(a,o){if(console.log(o),a){e.tableData.filter(function(e){return!e.IsDeleted}).length||(e.$msg.info("当前没有医嘱项目，请添加后再保存！"),t(!1));var i=Object(n["a"])({},e.commonData),r=i.OrderId;delete i.OrderId,e.tableData.filter(function(e){return e.ChildItems||(e.ChildItems=[]),e.ChildItems.forEach(function(t){var a=!0;e.CheckedList.forEach(function(e){t.DictItemCode===e&&(a=!1)}),t.IsDeleted=a}),!0}),i.InHouseId=e.$route.query.id;var s={};e.tableData.forEach(function(e){e.SampleCode?s[e.SampleCode]?s[e.SampleCode].push(e):s[e.SampleCode]=[e]:s.all?s.all.push(e):s.all=[e]});var c=[];for(var l in s)c.push({TestApplyMainModel:Object(n["a"])({},i),TestApplyDetailsModel:s[l]});r&&(c[0].TestApplyMainModel.OrderId=r),console.log(c,"dada"),t(c)}else t(!1),console.log("error submit!!")})})},selectRequestId:function(e){this.$emit("changrequestId",e)}}},u=m,d=(a("33d5"),a("2877")),p=Object(d["a"])(u,o,i,!1,null,null,null);t["a"]=p.exports},df52:function(e,t,a){"use strict";var o=a("e6af"),i=a.n(o);i.a},e6af:function(e,t,a){}}]);
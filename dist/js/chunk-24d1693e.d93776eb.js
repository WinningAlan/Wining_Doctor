(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24d1693e"],{"0437":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"consumables",class:{top0:!e.isShow}},[e.isShow?a("p",{staticClass:"consumables-button"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.add}},[e._v("新增")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.save(e.alterData.childData,"all")}}},[e._v("全部提交")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveTemplate}},[e._v("另存模板")]),a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择模板",size:"small"},on:{change:e.selectDeatil},model:{value:e.combo,callback:function(t){e.combo=t},expression:"combo"}},e._l(e.templateList,function(e){return a("el-option",{key:e.Id,attrs:{label:e.TemplateName,value:e.Id}})}),1),a("span",{staticClass:"name"},[e._v("选择模板:")])],1):e._e(),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.alterData.childData,"row-key":e.rowkey,"max-height":386},on:{"selection-change":e.selectionChange}},[e.isShow?a("el-table-column",{attrs:{type:"selection"}}):e._e(),a("el-table-column",{attrs:{"min-width":"100",label:"类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[!t.row.Status||t.row.AdviceItemId?[e._v(e._s(e._f("groupFilters")(t.row.GroupCode,e.groupArr,t.row.GroupName)))]:a("el-select",{attrs:{filterable:"",placeholder:"请选择","filter-method":e.filterMethod},on:{"visible-change":e.restore,change:function(a){e.changeValue(t.row,"group")}},model:{value:t.row.GroupCode,callback:function(a){e.$set(t.row,"GroupCode",a)},expression:"scope.row.GroupCode"}},e._l(e.groupOption,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e.GroupCode}})}),1)]}}])}),a("el-table-column",{attrs:{"min-width":"180",label:"计价项目"},scopedSlots:e._u([{key:"default",fn:function(t){return[!t.row.Status||t.row.AdviceItemId?[e._v(e._s(t.row.DictAdviceItemName||t.row.Name))]:a("el-select",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadMore,expression:"loadMore"}],ref:"costItem",staticClass:"costItem",attrs:{filterable:"",remote:"","default-first-option":"","value-key":"Id",placeholder:"项目名称/项目名称缩写","remote-method":e.remoteMethod,loading:e.loading},on:{change:function(a){e.changeValue(t.row,"item")},focus:function(a){e.itemFocus(t.row)}},model:{value:t.row.DictAdviceItem,callback:function(a){e.$set(t.row,"DictAdviceItem",a)},expression:"scope.row.DictAdviceItem"}},e._l(e.itemOption,function(t){return a("el-option",{key:t.Id,attrs:{label:t.Name,value:t}},[a("span",{staticClass:"name"},[e._v(e._s(t.Name))]),a("span",{staticClass:"specifications"},[e._v(e._s(t.Specifications))])])}),1)]}}])}),e.isShow?a("el-table-column",{attrs:{prop:"Specifications",label:"规格"}}):e._e(),a("el-table-column",{attrs:{prop:"Unit",label:"单位",width:"80"}}),a("el-table-column",{attrs:{prop:"Price",label:"单价",width:"80"}}),a("el-table-column",{attrs:{prop:"Count",label:"数量",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.Status?a("el-input-number",{attrs:{min:1,max:100,label:"描述文字",size:"small"},model:{value:t.row.Count,callback:function(a){e.$set(t.row,"Count",a)},expression:"scope.row.Count"}}):[e._v(e._s(t.row.Count))]]}}])}),e.isShow?a("el-table-column",{attrs:{prop:"OperatorName",label:"操作员"}}):e._e(),e.isShow?a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.IsCharge?e._e():a("p",{staticClass:"operation"},[t.row.Status?a("span",{on:{click:function(a){e.save(t.row,"one")}}},[e._v("提交")]):a("span",{on:{click:function(a){e.edit(t.row,!0)}}},[e._v("修改")]),a("span",{on:{click:function(a){e.retreat(t.row,t.$index)}}},[e._v("作废")])])]}}])}):e._e()],1),a("myAlert",{attrs:{visible:e.templateShow,title:"保存模板名称",callback:e.closeAlter,width:"500px"}},[a("div",{staticClass:"box"},[a("span",[e._v("模板名称:")]),a("el-input",{attrs:{placeholder:"请输入模板名称",size:"small"},model:{value:e.templateName,callback:function(t){e.templateName=t},expression:"templateName"}})],1)])],1)},i=[],r=a("2909"),o=(a("a481"),a("ac6a"),a("be94")),n=a("2f62"),l=a("98ad"),c={Count:1,DictAdviceItemId:null,DictAdviceItemName:null,Price:null,Specifications:null,Status:!0,Unit:null,Usage:null},u={name:"alterConsumables",props:{idKey:{type:String,default:"Group"},alterData:{type:Object,default:{}},isShow:{type:Boolean,default:!0}},components:{myAlert:l["a"]},data:function(){return{rowkey:function(e){return e.DictAdviceItemId},combo:"",comboOptions:[],groupOption:[],itemOption:[],childData:[],loading:!1,templateName:"",templateList:[],templateShow:!1,pageIndex:1}},watch:{"alterData.showAlter":{handler:function(e,t){e&&(this.combo="",this.selectArr=[])},immediate:!0,deep:!0}},created:function(){this.groupOption=this.groupArr,this.isShow&&this.getTemplateList()},computed:Object(o["a"])({},Object(n["b"])({user:"public/GET_USER",groupArr:"public/GET_GROUPARR"})),filters:{groupFilters:function(e,t,a){var s=a;return t.forEach(function(t){t.Code==e&&(s=t.Name)}),s}},methods:{add:function(){if(!this.groupArr.length)return this.$msg.info("无耗材数据");var e=Object(o["a"])({},c);e.GroupCode=this.groupArr[0].GroupCode,e.OperatorName=this.user.UserInfo.Name,e._Id=+new Date,this.alterData.childData.unshift(e)},itemFocus:function(e){this.rowData=e,this.itemOption=[],this.pageIndex=1,this.remoteMethod("",1)},changeValue:function(e,t){if(console.log(e,e.DictAdviceItem),"item"===t){var a=e.DictAdviceItem;for(var s in e.GroupCode=a.GroupCode,console.log(a),e.DictAdviceItemId=a.Id,e.DictAdviceItemCode=a.Code,e.DictAdviceItemName=a.Name,a)e.hasOwnProperty(s)&&"Id"!=s&&"Group"!=s&&(e[s]=a[s])}else for(var i in console.log(e,t),c)e[i]=c[i]},restore:function(e){e&&(this.groupOption=this.groupArr)},filterMethod:function(e){e=e&&e.replace(/(^\s*)|(\s*$)/g,""),this.groupOption=e?this.groupArr.filter(function(t){if(console.log(t.InputCode.indexOf(e)>-1,t.InputCode),t.Name.indexOf(e)>-1||t.InputCode.indexOf(e)>-1)return!0}):this.groupArr},remoteMethod:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;console.log(this.rowData,e),e=e&&e.replace(/(^\s*)|(\s*$)/g,""),this.currentKeyWord=e,this.loading=1===a,this.$Api.getCostItemList({groupCode:this.rowData.GroupCode,content:e,pageIndex:a,pageSize:10}).then(function(e){if(t.loading=!1,e.Status){var s,i=e.Data[0]?e.Data[0].DictAdviceItemModels:[];if(1===a)t.itemOption=i;else(s=t.itemOption).push.apply(s,Object(r["a"])(i))}else t.itemOption=[]})},edit:function(e,t){this.$set(e,"Status",t)},save:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"one";console.log("alterData",e,this.alterData);var s="one"==a?[e]:e,i=!0,r=[],o=s.filter(function(e){return console.log(e),e.AdviceItemId?r.push({Id:e.AdviceItemId,DictAdviceItemCode:e.DictAdviceItemCode,Count:e.Count,InHouseId:t.alterData.inHouseId}):r.push({DictAdviceItemCode:e.DictAdviceItemCode,Count:e.Count,InHouseId:t.alterData.inHouseId}),e.DictAdviceItemCode||(i=!1),e.Status});return i?o.length?(r={InHouseId:this.$route.query.id,DoctorOrderId:this.alterData.DoctorOrderId,AdviceItems:r},void this.$Api.saveCostItem(r).then(function(s){t.$msg[s.Status?"success":"warning"](s.Message),s.Status&&("one"==a?(t.$set(e,"Status",!1),e.AdviceItemId=e.AdviceItemId?e.AdviceItemId:s.Data[0]):t.alterData.childData.forEach(function(e){e.Status=!1}))})):this.$msg.warning("没有新增或修改的费用"):this.$msg.warning("计价项目不允许为空")},retreat:function(e,t){var a=this;this.$confirm("此操作将将永久作废该记录, 是否继续?","",{customClass:"msg-box",type:"warning"}).then(function(){e.AdviceItemId?a.$Api.deleteCostItem({materialId:e.AdviceItemId,DoctorOrderId:a.alterData.DoctorOrderId,hisxh:e.Hisxh}).then(function(s){a.$msg[s.Status?"success":"warning"](s.Message),s.Status&&a.alterData.childData.splice(t,1),s.Status&&a.deleteSelect(e.AdviceItemId)}):(a.alterData.childData.splice(t,1),a.deleteSelect(e._Id))}).catch(function(){a.$msg.info("已取消操作")})},saveTemplate:function(){var e=this,t=!0;this.selectArr.length>0?(console.log(this.selectArr),this.selectArr.forEach(function(a){if(!a.DictAdviceItemCode)return e.$msg.warning("项目名称为必填项!!"),void(t=!1)}),t&&(this.templateShow=!0)):this.$msg.warning("请选择需要另存模板的材料!!!")},closeAlter:function(e){var t=this;if(console.log(e),e){var a={TemplateName:this.templateName,TemplateDetails:[]};this.selectArr.forEach(function(e){a.TemplateDetails.push({DictAdviceItemCode:e.DictAdviceItemCode,GroupCode:e.GroupCode,Count:e.Count})}),console.log(a),this.$Api.saveCostTemplate(a).then(function(e){t.$msg[e.Status?"success":"error"](e.Message),e.Status&&(t.templateName="",t.getTemplateList(),t.templateShow=!1)})}else this.templateShow=!1},getTemplateList:function(){var e=this;this.$Api.getCostTemplate().then(function(t){e.templateList=t.Data||[]})},getTemplateDetail:function(e){var t=this;this.$Api.getCostTemplateDetails({templateId:e}).then(function(e){var a;e.Status&&(e.Data&&e.Data.forEach(function(e){e.Status=!0,e.DictAdviceItem=e.DictAdviceItemName,e._Id=Math.random()}),(a=t.alterData.childData).unshift.apply(a,Object(r["a"])(e.Data)))})},selectDeatil:function(e){e&&this.getTemplateDetail(e)},loadMore:function(){++this.pageIndex,this.remoteMethod(this.currentKeyWord,this.pageIndex)},selectionChange:function(e){this.selectArr=e},deleteSelect:function(e){this.selectArr=this.selectArr.filter(function(t){return t.AdviceItemId?e!==t.AdviceItemId:e!=t._Id})}},directives:{loadmore:{bind:function(e,t){var a=e.querySelector(".el-select-dropdown .el-select-dropdown__wrap");a.addEventListener("scroll",function(){var e=this.scrollHeight-this.scrollTop<=this.clientHeight;e&&t.value()})}}}},d=u,p=(a("3b47"),a("2877")),m=Object(p["a"])(d,s,i,!1,null,"1fe67664",null);t["a"]=m.exports},"26c1":function(e,t,a){},"2d91":function(e,t,a){},"2e7f":function(e,t,a){"use strict";a.d(t,"b",function(){return r}),a.d(t,"e",function(){return o}),a.d(t,"q",function(){return n}),a.d(t,"d",function(){return l}),a.d(t,"v",function(){return c}),a.d(t,"g",function(){return u}),a.d(t,"o",function(){return d}),a.d(t,"n",function(){return p}),a.d(t,"f",function(){return m}),a.d(t,"m",function(){return f}),a.d(t,"p",function(){return v}),a.d(t,"l",function(){return h}),a.d(t,"i",function(){return w}),a.d(t,"t",function(){return _}),a.d(t,"r",function(){return g}),a.d(t,"w",function(){return x}),a.d(t,"j",function(){return I}),a.d(t,"k",function(){return b}),a.d(t,"h",function(){return C}),a.d(t,"s",function(){return D}),a.d(t,"u",function(){return S}),a.d(t,"c",function(){return k}),a.d(t,"a",function(){return y});var s=a("fccc"),i=a("46a9"),r=[{text:"过敏药物名称",value:"MedicineName"},{text:"皮试日期",value:"SkinTestTime",formatter:i["a"]},{text:"开始时间",value:"StartTime",formatter:i["a"]},{text:"结束时间",value:"EndTime",formatter:i["a"]},{text:"过敏类型",value:"AllergyTypeDesc"}],o=[{text:"过敏食物名称",value:"Name"},{text:"录入日期",value:"InputTime",formatter:i["a"]},{text:"开始日期",value:"StartTime",formatter:i["a"]},{text:"过敏类型",value:"AllergyTypeDesc"}],n=[{text:"过敏造影剂名称",value:"Name"},{text:"录入日期",value:"InputTime",formatter:i["a"]},{text:"开始日期",value:"StartTime",formatter:i["a"]},{text:"过敏类型",value:"AllergyTypeDesc"}],l=[{text:"其他过敏源名称",value:"Name"},{text:"录入日期",value:"InputTime",formatter:i["a"]},{text:"开始日期",value:"StartTime",formatter:i["a"]},{text:"过敏类型",value:"AllergyTypeDesc"}],c=[{text:"IDM",value:"IdmId"},{text:"药品名称",value:"MedicineName"},{text:"症状",value:"Symptom"},{text:"严重程度",value:"SeverityTypeDesc"},{text:"发生日期",value:"StartTime",formatter:i["a"]}],u=[{text:"过敏项目名称",value:"Name"},{text:"皮试日期",value:"SkinTestTime",formatter:i["a"]},{text:"开始日期",value:"StartTime",formatter:i["a"]},{text:"结束日期",value:"EndTime",formatter:i["a"]},{text:"过敏类别",value:"AllergyCategory"},{text:"过敏类型",value:"AllergyType"}],d=[{text:"时间",value:"time"},{text:"体温",value:"T"},{text:"哭声",value:"ku"},{text:"肤色",value:"fuse"},{text:"呼吸",value:"huxi"},{text:"反应",value:"fanyin"},{text:"呕吐",value:"ot"},{text:"脐带",value:"qd"},{text:"小便",value:"xb"},{text:"其他",value:"qt"},{text:"签名",value:"qm"}],p=[{text:"",value:"none"},{text:"Hoffmann",value:"Hoffmann"},{text:"Rossolimo",value:"Rossolimo"},{text:"Babinski",value:"Babinski"},{text:"Chaddock",value:"Chaddock"},{text:"髌阵挛",value:"b"},{text:"踝阵挛",value:"luo"}],m=[{text:"GCS评分",value:"grade"},{text:"睁眼反应",value:"eyes",width:"100px"},{width:"100px",text:"语言反应",value:"language"},{width:"100px",text:"运动反应",value:"sports"},{text:"总分",value:"allCount"}],f=[{width:"100px",text:"项目",value:"items"},{width:"150px",text:"参考值",value:"referenceValue"},{width:"150px",text:"测量值",value:"measuredValue"}],v=[{text:"体征记录",value:"Content",width:"450"},{text:"护士",value:"UpdateUserName"},{text:"记录时间",value:"UpdateTime",formatter:i["a"]}],h=[{text:"护理记录",value:"Content",width:"450"},{text:"护士",value:"护士签名"},{text:"记录时间",value:"Time"}],w=(i["a"],[{text:"报告号",value:"ReportNo"},{text:"检查项目",value:"ReportCategoryName"},{text:"检查结果",value:"Content",width:"250"},{text:"申请人",value:"ApplyName",maxWidth:"80px"},{text:"申请时间",value:"ApplyTime",width:"100",formatter:i["a"]}]),_=[{text:"报告号",value:"ReportNo"},{text:"检验项目",value:"ReportCategoryName"},{text:"标本",value:"Sample"},{text:"申请人",value:"ApplyName",width:"70"},{text:"申请时间",value:"ApplyTime",width:"100",formatter:i["a"]},{text:"危急值",value:"CrisisFlag",maxWidth:"70"}],g=[{text:"项目",value:"ItemName"},{text:"结果",value:"ItemValue"},{text:"提示",value:"Flag",formatter:function(e){return 1===e?"↓":2===e?"↑":""}},{text:"单位",value:"Unit"},{text:"参考范围",value:"Range",maxWidth:"100"},{text:"检测方法",value:"lookOver"},{text:"趋势图",value:"operation"}],x=[{text:"项目",value:"adviceName"},{text:"频次",value:"Frequency"}],I=[{text:"膳食项目",value:"adviceName"},{text:"频次",value:"Frequency"},{text:"剂量",value:"Unit"},{text:"单价",value:"Price",maxWidth:70,formatter:function(e){return(+e).toFixed(2)}}],b=[{text:"护理项目",value:"adviceName"},{text:"频次",value:"Frequency"},{text:"单价",value:"Price",maxWidth:70,formatter:function(e){return(+e).toFixed(2)}}],C=[{text:"检查项目",value:"adviceName"},{text:"是否是医保",value:"InsuranceUseFlag"},{text:"费用",value:"Price",formatter:function(e){return(+e).toFixed(2)}}],D=[{text:"检验项目",value:"adviceName"},{text:"标本",value:"SampleCode"},{text:"标本说明",value:"Attention",editType:"text"},{text:"是否是医保",value:"InsuranceUseFlag"},{text:"费用",value:"Price",maxWidth:70,formatter:function(e){return(+e).toFixed(2)}}],S=[{text:"治疗项目",value:"adviceName"},{text:"频次",value:"Frequency"},{text:"数量",value:"Unit"},{text:"单价",value:"Price",maxWidth:70,formatter:function(e){return(+e).toFixed(2)}}],k=[{text:"药品名称",value:"adviceName",width:180},{text:"剂量",value:"specimen",width:80},{text:"数量",value:"remarks",width:30},{text:"自备药",value:"IsSelfProvided",editType:"switch",width:30},{text:"皮试",value:"IsSkinTest",editType:"switch",width:30},{text:"审",value:"ReimbursementType",editType:"switch",width:30},{text:"单价",value:"Price",maxWidth:80,formatter:function(e){return(+e).toFixed(2)}},{text:"是否是医保",value:"InsuranceUseFlag",maxWidth:100},{text:"医保限制说明",value:"Memo",maxWidth:105}],y=[{text:"用血方式",value:"BloodWay",editType:"select",options:[{Text:"要求1",Value:1},{Text:"要求2",Value:2}]},{text:"用血要求",value:"Alias"},{text:"用量",value:"remarks"}];s["b"]},3828:function(e,t,a){"use strict";var s=function(e,t){var a=t._c;return a("div",{staticClass:"advice-content"},[t.props.Isprescription?[t.props.row.prescriptionDetailListInfo.length>1?[t._m(0),a("div",{staticClass:"advice-content-name drup"},t._l(t.props.row.prescriptionDetailListInfo,function(e,s){return a("p",{key:s,staticClass:"item"},[e.Insurance?a("span",[t._v(t._s(e.Insurance))]):t._e(),e.SpecialName&&"普通"!==e.SpecialName?a("span",[t._v("["+t._s(e.SpecialName)+"]")]):t._e(),a("span",[t._v(t._s(e.MedicineName)+"  ")]),a("span",[t._v(t._s(e.SpecificationName)+"  "+t._s(e.Dose)+t._s(e.Unit)+"  ")]),e.IsSelfProvided?a("span",{staticClass:"icon-build-in"}):t._e()])}),0),a("div",{staticClass:"advice-content-content"},[t._v("\n          "),t.props.row.IsOutHospitalMedicine?a("span",{staticClass:"icon-dai"}):t._e()])]:[a("div",{staticClass:"advice-content-name drup"},[t.props.row.prescriptionDetailListInfo[0].Insurance?a("span",[t._v(t._s(t.props.row.prescriptionDetailListInfo[0].Insurance))]):t._e(),t.props.row.prescriptionDetailListInfo[0].SpecialName&&"普通"!==t.props.row.prescriptionDetailListInfo[0].SpecialName?a("span",[t._v("["+t._s(t.props.row.prescriptionDetailListInfo[0].SpecialName)+"]")]):t._e(),a("span",[t._v(t._s(t.props.row.prescriptionDetailListInfo[0].MedicineName)+"  "+t._s(t.props.row.prescriptionDetailListInfo[0].SpecificationName)+"  ")]),a("span",[t._v(t._s(t.props.row.prescriptionDetailListInfo[0].Dose)+t._s(t.props.row.prescriptionDetailListInfo[0].Unit)+"  ")]),t.props.row.prescriptionDetailListInfo[0].IsSelfProvided?a("span",{staticClass:"icon-build-in"}):t._e(),t.props.row.IsOutHospitalMedicine?a("span",{staticClass:"icon-dai"}):t._e()])]]:[a("div",{staticClass:"advice-content-icon"},[a("span",{staticClass:"adviceIcon"},[t._v(t._s(t.props.row.OrderClassificationWord))])]),14===t.props.row.OrderType?[t.props.row.OrderDetails.length>1?[t._m(1),a("div",{staticClass:"advice-content-name"},t._l(t.props.row.OrderDetails,function(e,s){return a("div",{key:s,staticClass:"item"},[a("p",[e.Insurance?a("span",[t._v(t._s(e.Insurance))]):t._e(),e.SpecialName&&"普通"!==e.SpecialName?a("span",[t._v("["+t._s(e.SpecialName)+"]")]):t._e(),a("span",[t._v(t._s(e.MedicineName)+" ")]),e.IsSkinTest?a("span",{staticClass:"icon-skin"}):t._e(),e.IsSelfProvided?a("span",{staticClass:"icon-build-in"}):t._e()]),a("p",[t._v("\n              "+t._s(e.SpecificationName)+"  "+t._s(+e.Dose.toFixed(4))+t._s(e.Unit)+"  "+t._s(1===t.props.row.EffectiveTime?e.Dosage:"")+t._s(1===t.props.row.EffectiveTime?e.DosageUnit:"")+"\n            ")])])}),0),a("div",{staticClass:"advice-content-content"},[a("p",[t._v(t._s(t.props.row.UsageText)+" "+t._s(t.props.row.FrequencyText)+"  "+t._s(t.props.row.OrderDays?t.props.row.OrderDays+"天":"")+" "),t.props.row.IsOutHospitalMedicine?a("span",{staticClass:"icon-dai"}):t._e()]),t.props.row.DrippingSpeed?a("p",[t._v("滴速 "+t._s(t.props.row.DrippingSpeed)+" ml/min")]):t._e()])]:[a("div",{staticClass:"advice-content-content"},[a("p",[t.props.row.OrderDetails[0].Insurance?a("span",[t._v(t._s(t.props.row.OrderDetails[0].Insurance))]):t._e(),t.props.row.OrderDetails[0].SpecialName&&"普通"!==t.props.row.OrderDetails[0].SpecialName?a("span",[t._v("["+t._s(t.props.row.OrderDetails[0].SpecialName)+"]")]):t._e(),a("span",[t._v(t._s(t.props.row.OrderDetails[0].MedicineName)+"  "+t._s(t.props.row.OrderDetails[0].SpecificationName)+" ")])]),a("p",[t._v("\n            "+t._s(+t.props.row.OrderDetails[0].Dose.toFixed(4))+t._s(t.props.row.OrderDetails[0].Unit)+"  "+t._s(1===t.props.row.EffectiveTime?t.props.row.OrderDetails[0].Dosage:"")+t._s(1===t.props.row.EffectiveTime?t.props.row.OrderDetails[0].DosageUnit:"")+" "+t._s(t.props.row.UsageText)+"  "+t._s(t.props.row.FrequencyText)+"  "+t._s(t.props.row.OrderDays?t.props.row.OrderDays+"天":"")+"  \n            "),t.props.row.DrippingSpeed?a("span",[t._v("滴速 "+t._s(t.props.row.DrippingSpeed)+" ml/min  ")]):t._e(),t.props.row.OrderDetails[0].IsSkinTest?a("span",{staticClass:"icon-skin"}):t._e(),t.props.row.OrderDetails[0].IsSelfProvided?a("span",{staticClass:"icon-build-in"}):t._e(),t.props.row.IsOutHospitalMedicine?a("span",{staticClass:"icon-dai"}):t._e()])])]]:5===t.props.row.OrderType||3===t.props.row.OrderType||122===t.props.row.OrderType||31===t.props.row.OrderType?[a("div",{staticClass:"advice-content-content"},[t._v(t._s(t.props.row.OrderContent)+" "+t._s(t.props.row.FrequencyText))])]:0===t.props.row.OrderType||1===t.props.row.OrderType?[a("div",{staticClass:"advice-content-content"},[t._v("\n         "+t._s(t.props.row.OrderContent)+"  "+t._s(1===t.props.row.EffectiveTime?t.props.row.OrderDetails[0].Count:"")+t._s(1===t.props.row.EffectiveTime?t.props.row.OrderDetails[0].Unit:"")+"  "+t._s(t.props.row.FrequencyText)+"\n        "),t.props.row.IsEmergency?a("span",{staticClass:"icon-urgency"}):t._e(),t.props.row.IsBed?a("span",{staticClass:"icon-bed"}):t._e()])]:15===t.props.row.OrderType?[a("div",{staticClass:"advice-content-content"},[t._v(t._s(t.props.row.OrderContent))])]:7===t.props.row.OrderType?[a("div",{staticClass:"advice-content-content"},t._l(t.props.row.OrderDetails,function(e,s){return a("p",{key:s},[t._v(t._s(e.DictItemName)+"  "+t._s(e.SampleName))])}),0),t.props.row.CheckFormModel?a("div",{staticClass:"jianca"},[t.props.row.CheckFormModel.IsBed?a("span",{staticClass:"icon-bed"}):t._e(),t.props.row.CheckFormModel.IsEmergency?a("span",{staticClass:"icon-urgency"}):t._e()]):t._e()]:8===t.props.row.OrderType?[a("div",{staticClass:"advice-content-content"},t._l(t.props.row.OrderDetails,function(e,s){return a("p",{key:s,staticClass:"warp"},[t._v("\n          "+t._s(e.DictItemName)+"  "+t._s(e.SampleName)+"\n          "),1===t.props.row.Status&&t.props.isCheckedCharge?t._l(e.ChildItems,function(e){return a("p",{key:e.Id,staticClass:"min-item"},[t._v(t._s(e.DictItemName))])}):t._e()],2)}),0),t.props.row.TestFormModel?a("div",{staticClass:"jianca"},[t.props.row.TestFormModel.IsOtherTest?a("span",{staticClass:"icon-out"}):t._e(),t.props.row.TestFormModel.IsEmergency?a("span",{staticClass:"icon-urgency"}):t._e()]):t._e()]:4===t.props.row.OrderType?[t.props.row.BloodTypeName?a("div",{staticClass:"advice-content-blood"},[a("span",[t._v(t._s(t.props.row.BloodTypeName)+"  ")]),t.props.row.RH?a("span",[t._v("RH"),a("sup",[t._v(t._s("阳性"===t.props.row.RH?"+":"-"))]),t._v("  ")]):t._e()]):t._e(),a("div",{staticClass:"advice-content-name"},t._l(t.props.row.OrderDetails,function(e,s){return a("div",{key:s,staticClass:"item"},[t._v("\n            "+t._s(e.ItemName)+"  "+t._s(e.Count)+" "+t._s(e.Unit)+"\n          ")])}),0),t._m(2)]:t._e()]],2)},i=[function(e,t){var a=t._c;return a("div",{staticClass:"advice-content-group"},[a("p",{staticClass:"item"})])},function(e,t){var a=t._c;return a("div",{staticClass:"advice-content-group"},[a("div",{staticClass:"item"})])},function(e,t){var a=t._c;return a("div",{staticClass:"advice-content-content"},[a("p",[t._v("静滴 ST")])])}],r=(a("637f"),a("2877")),o={},n=Object(r["a"])(o,s,i,!0,null,"7fb2b062",null);t["a"]=n.exports},"3b47":function(e,t,a){"use strict";var s=a("9c25"),i=a.n(s);i.a},"637f":function(e,t,a){"use strict";var s=a("2d91"),i=a.n(s);i.a},"8f72":function(e,t,a){"use strict";var s=a("26c1"),i=a.n(s);i.a},"94b8":function(e,t,a){},"9c25":function(e,t,a){},b6be:function(e,t,a){"use strict";var s=a("94b8"),i=a.n(s);i.a},f1ed:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",e._g(e._b({ref:e.isDrop?"drop":"reference",staticClass:"doctorAdviceList",staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-key":"OrderId","row-class-name":e.rowClass,"highlight-current-row":""},on:{"cell-mouse-enter":e.moreInfoShow,"cell-mouse-leave":e.moreInfoShow}},"el-table",e.$attrs,!1),e.$listeners),[e.isDrop?a("el-table-column",{attrs:{type:"expand",width:"1"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("expand",null,{scope:t})]}}])}):e._e(),e.isSelection?a("el-table-column",{attrs:{type:"selection",width:"30","reserve-selection":!0,selectable:e.selectable}}):e._e(),e.isPackage||e.isHistoryData?e._e():a("el-table-column",{attrs:{label:"状态",width:"65"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-popover",{attrs:{placement:"bottom-end",width:"70",trigger:"click",offset:"30","popper-class":"status"}},[a("el-checkbox",{attrs:{indeterminate:e.isStatus},on:{change:function(t){e.handleCheckAllChange("statusChecked",t)}},model:{value:e.isStatusAll,callback:function(t){e.isStatusAll=t},expression:"isStatusAll"}},[e._v("全选")]),a("el-checkbox-group",{on:{change:function(t){e.checkedStatusChange("statusChecked",t)}},model:{value:e.checkedStatus,callback:function(t){e.checkedStatus=t},expression:"checkedStatus"}},e._l(e.statusOptions,function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.text))])}),1),a("span",{staticClass:"unfold el-icon-caret-bottom",attrs:{slot:"reference"},slot:"reference"},[e._v("状态")])],1)]}},{key:"default",fn:function(t){return a("span",{staticClass:"bg",class:"bg"+t.row.Status},[e._v(e._s(e._f("statusFilter")(t.row.Status,t.row.EffectiveTime,e.statusOptions)))])}}])}),a("el-table-column",{attrs:{label:"长/临",width:"65"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-popover",{attrs:{placement:"bottom-end",width:"70",trigger:"click",offset:60,"popper-class":"status"}},[a("el-checkbox",{attrs:{indeterminate:e.isEffective},on:{change:function(t){e.handleCheckAllChange("effectiveChecked",t)}},model:{value:e.isEffectiveAll,callback:function(t){e.isEffectiveAll=t},expression:"isEffectiveAll"}},[e._v("全选")]),a("el-checkbox-group",{on:{change:function(t){e.checkedStatusChange("effectiveChecked",t)}},model:{value:e.checkedEffective,callback:function(t){e.checkedEffective=t},expression:"checkedEffective"}},[a("el-checkbox",{attrs:{label:2}},[e._v("长")]),a("el-checkbox",{attrs:{label:1}},[e._v("临")])],1),a("span",{staticClass:"unfold el-icon-caret-bottom",attrs:{slot:"reference"},slot:"reference"},[e._v("长/临")])],1)]}},{key:"default",fn:function(t){return[e._v(e._s(1===t.row.EffectiveTime?"临":"长"))]}}])}),e.isPackage?e._e():a("el-table-column",{attrs:{label:"开始时间","min-width":120},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("timeFilter")(t.row.StartTime?t.row.StartTime:t.row.OrderTime?t.row.OrderTime:t.row.CreateTime)))]}}])}),a("el-table-column",{attrs:{label:"医嘱内容","min-width":390,"class-name":"height100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!==t.row.Status&&t.row.DoctorOrderAdviceItems?a("el-popover",{attrs:{placement:"bottom-start",width:"620",disabled:7===t.row.Status||0===t.row.DoctorOrderAdviceItems.length||e.isQuote,"open-delay":200,"popper-class":"info-more",trigger:"hover"},model:{value:t.row.isInfoShow,callback:function(a){e.$set(t.row,"isInfoShow",a)},expression:"scope.row.isInfoShow"}},[a("alterConsumables",{attrs:{isShow:!1,alterData:{childData:t.row.DoctorOrderAdviceItems}}}),a("advice-content",{attrs:{slot:"reference",row:t.row,isCheckedCharge:e.isCheckedCharge},slot:"reference"})],1):a("advice-content",{attrs:{row:t.row,isCheckedCharge:e.isCheckedCharge}})]}}])}),a("el-table-column",{attrs:{label:"",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[14===t.row.OrderType?a("div",[t.row.OrderDetails.length>1?e._l(t.row.OrderDetails,function(t,s){return a("div",{key:s,staticStyle:{"margin-bottom":"14px"}},[a("p",{staticClass:"blue m11",class:{red:t.SkinTestName&&t.SkinTestName.indexOf("阳")>-1}},[e._v(" "+e._s(t.SkinTestName?t.SkinTestName:" "))]),a("p",{staticClass:"blue",class:{red:t.SkinTestName&&t.SkinTestName.indexOf("阳")>-1}},[e._v(" "+e._s(t.SkinMedicinalBatchCode?t.SkinMedicinalBatchCode:" "))])])}):[a("p",{staticClass:"blue",class:{red:t.row.OrderDetails[0].SkinTestName&&t.row.OrderDetails[0].SkinTestName.indexOf("阳")>-1}},[e._v(" "+e._s(t.row.OrderDetails[0].SkinTestName))]),t.row.OrderDetails[0].SkinMedicinalBatchCode?a("p",{staticClass:"blue",class:{red:t.row.OrderDetails[0].SkinTestName&&t.row.OrderDetails[0].SkinTestName.indexOf("阳")>-1}},[e._v(" "+e._s(t.row.OrderDetails[0].SkinMedicinalBatchCode))]):e._e()]],2):e._e()]}}])}),e.isPackage||e.isHistoryData?e._e():a("el-table-column",{attrs:{label:"执行/停止时间","min-width":120},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.Status?[e._v(e._s(e._f("timeFilter")(t.row.EndTime)))]:6===t.row.Status?[e._v(e._s(e._f("timeFilter")(t.row.StopTime)))]:7===t.row.Status?[e._v(e._s(e._f("timeFilter")(t.row.InvalidTime)))]:[e._v(e._s(e._f("timeFilter")(1===t.row.EffectiveTime&&t.row.OrderExcuteTime)))]]}}])}),e.isPackage?e._e():a("el-table-column",{attrs:{label:"开嘱医生",width:"80",prop:"CreateUserName"}}),e.isHistoryData?a("el-table-column",{attrs:{label:"审核护士",prop:"AuditUserName",width:80}}):e._e(),e.isHistoryData?a("el-table-column",{attrs:{label:"停止时间",prop:"StopTime","min-width":100},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("timeFilter")(t.row.StopTime)))]}}])}):e._e(),e.isHistoryData?a("el-table-column",{attrs:{label:"停嘱医生",prop:"StopUserName",width:80}}):e._e(),e.isHistoryData?a("el-table-column",{attrs:{label:"执行时间",prop:"OrderExcuteTime","min-width":100},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("timeFilter")(t.row.OrderExcuteTime)))]}}])}):e._e(),e.isHistoryData?a("el-table-column",{attrs:{label:"执行者",prop:"ExcuteUserName",width:80}}):e._e(),e.isPackage?a("el-table-column",{attrs:{label:"备注",prop:"Remark"}}):e._e(),e.isHistoryData?e._e():a("el-table-column",{attrs:{width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isDrop&&e.showEdit&&8!=e.patientMsg.Status?a("svg-icon",{staticClass:"delete no",attrs:{iconClass:"del"},on:{click:function(a){a.stopPropagation(),e.deleteItem(t.row.OrderId,t.row._index)}}}):e._e(),e._t("cost",null,{scope:t}),4!=t.row.Status||8==e.patientMsg.Status||t.row.IsAccept?e._e():a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"待处理",placement:"top-start"}},[a("svg-icon",{staticClass:"delete no sendBack",attrs:{iconClass:"sendBack"},on:{click:function(a){a.stopPropagation(),e.sendBack(t.row.OrderId)}}})],1)]}}])})],1)},i=[],r=a("2909"),o=(a("ac6a"),a("6762"),a("2fdb"),a("be94")),n=a("3828"),l=a("0437"),c=a("d634"),u=a("2f62"),d=(a("c9b7"),[1,2,3,4,5,-5,6,7]),p={name:"doctorAdviceList",components:{adviceContent:n["a"],alterConsumables:l["a"]},data:function(){return{isStatusAll:!0,isStatus:!1,checkedStatus:d,isEffectiveAll:!0,isEffective:!1,visible:!1,checkedEffective:[1,2],statusOptions:c["D"],sendOrderId:"",alterData:{childData:[]}}},computed:Object(o["a"])({},Object(u["b"])({patientMsg:"public/GET_PATIENTMSG",isCheckedCharge:"configuration/GET_ISCHECKEDCHARGE"})),mounted:function(){this.isQuote&&(this.statusOptions=this.statusOptions.slice(1),this.checkedStatus=this.checkedStatus.slice(1))},watch:{tableData:{handler:function(e,t){var a=this;this.$nextTick(function(){a.isDrop&&a.rowDrop()})},immediate:!0}},props:{isSelection:{type:Boolean,default:!0},tableData:{type:Array,default:function(){return[]}},isDrop:{type:Boolean,default:!1},isPackage:{type:Boolean,default:!1},isHistoryData:{type:Boolean,default:!1},showEdit:{type:Boolean,default:!0},statusChecked:{type:Array,default:function(){return[]}},effectiveChecked:{type:Array,default:function(){return[]}},isQuote:{type:Boolean,default:!1},errorAdvice:{type:Array,default:function(){return[]}}},methods:{selectable:function(e){return!this.isHistoryData||14!==e.OrderType||!e._IsHis||!!e.PharmacyNumber},rowClass:function(e){var t=e.row,a=this.errorAdvice.includes(t.OrderId)?"pointer error":"pointer";return 7===t.Status?a+" red":a},rowExpansion:function(e,t){this.$refs.drop.toggleRowExpansion(e,t)},checked:function(e){var t=this,a=this.$refs[this.isDrop?"drop":"reference"];"clearSelection"===e?a.clearSelection():this.$nextTick(function(){t.tableData.forEach(function(e){a.toggleRowSelection(e,!0)})})},handleCheckAllChange:function(e,t){this.checkedStatus=t?d:[],"statusChecked"===e?(this.checkedStatus=t?d:[],this.isStatus=!1,this.$emit("update:"+e,Object(r["a"])(this.checkedStatus))):(this.checkedEffective=t?[1,2]:[],this.isEffective=!1,this.$emit("update:"+e,Object(r["a"])(this.checkedEffective))),console.log(e,t)},checkedStatusChange:function(e,t){this.$emit("update:"+e,Object(r["a"])(t)),console.log(t);var a=t.length;"statusChecked"===e?(this.isStatus=a>0&&a<8,this.isStatusAll=0!==a&&8===a):(this.isEffective=a>0&&a<2,this.isEffectiveAll=0!==a&&2===a)},deleteItem:function(e,t){var a=this;console.log(e,t),this.$confirm("该操作将删除该医嘱,是否继续?","",{type:"warning"}).then(function(){a.$parent.deleteAdviceList([e],t)}).catch(function(){a.$msg.info("已取消操作")})},drop:function(e){var t=this,a=e.dataTransfer.getData("id");e.preventDefault();for(var s="1",i=0;i<e.path.length;i++){var r=e.path[i];if(r.className&&r.className.indexOf("pointer")>-1){s=r.getAttribute("data-id");break}}if(s!==a){var o=this.isPackage?"PackageGroupDrugAdvice":"groupDrugAdvice";this.$Api[o]([s,a]).then(function(e){if(console.log(e,"drop"),t.$msg[e.Status?"success":"warning"](e.Message),e.Status)if(t.isPackage){var a=t.$parent.orderPackageParams.OrderPackageId||"00000000-0000-0000-0000-000000000000";t.$parent.getPackageDetail(a,2)}else t.$parent.getAdviceList("saveAdviceList")}),console.log(a,s,this.$parent.getAdviceList)}},dragstart:function(e,t){console.log(t,e,this),t.dataTransfer.setData("id",e)},dragover:function(e){e.preventDefault()},rowDrop:function(){for(var e=document.querySelectorAll(".drop .el-table__body-wrapper tbody >.el-table__row.pointer"),t=0;t<e.length;t++){var a=e[t];a.setAttribute("data-id",this.tableData[t].OrderId),a.ondrop=null,a.ondragover=null,a.ondragstart=null,a.setAttribute("draggable",!1),14===this.tableData[t].OrderType&&(a.setAttribute("draggable",!0),a.ondrop=this.drop,a.ondragover=this.dragover,a.ondragstart=this.dragstart.bind(this,this.tableData[t].OrderId))}},sendBack:function(e){var t=this;console.log(e),this.sendOrderId=e,this.$confirm("该条医嘱已被护士退回，是否接受本次退回？","",{type:"warning",confirmButtonText:"接受",cancelButtonText:"拒绝",distinguishCancelAndClose:!0}).then(function(){var a={MainOrderId:e,IsAccept:!0,InHouseId:t.patientMsg.InHouseId};t.sendBackAdv(a,!0)}).catch(function(a){var s={MainOrderId:e,IsAccept:!1,InHouseId:t.patientMsg.InHouseId};"cancel"===a&&t.sendBackAdv(s,!1)})},sendBackAdv:function(e,t){var a=this;this.$Api.sendBackAdv(e).then(function(e){console.log("res",e),a.$msg[e.Status?"success":"warning"](e.Message),e.Status&&(a.$parent.getAdviceList("saveAdviceList"),a.$parent.getAdviceList("doctorAdviceListData"))})},moreInfoShow:function(e,t,a,s){(t.label||60!==t.width)&&(this.alterData.childData=e.DoctorOrderAdviceItems||[],e.hasOwnProperty("isInfoShow")?e.isInfoShow="mouseleave"!==s.type:this.$set(e,"isInfoShow","mouseleave"!==s.type))}}},m=p,f=(a("8f72"),a("b6be"),a("2877")),v=Object(f["a"])(m,s,i,!1,null,null,null);t["a"]=v.exports}}]);